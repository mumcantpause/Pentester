```
GTFob




-Pn  
Disabilita richieste ICMP Echo

  
-n  
Disabilita risoluzione DNS  
  
--top-ports  
100 scansione top porte

  
-p-  
scansione tutte le 65k porte  
  
default port scan è 1000  
  
-p22-110  
scansione porte tra 22 e 110

  
-p22,25  
scansione porte specificate 22 e 25

  
  
-F  
scansiona prima 100 porte

  
-sS  
Invio all'host un TCP Syn  
 

sA  
Invio all'host un ACK TCP  
  
-sU  
Scansione UDP  
  
-sV  
Scansione servizi rilevati e versioni

  
Nmap –O -> Identify operating system

-oA -> All format report  
-oX -> XML Format

-oG -> Greppable Format

-oN -> .nmap extension  
  
-iL  
Esegue scansioni definite su obiettivi nell'elenco "hosts.lst" fornito  
  
--disable-arp-ping  
Disabilita il ping ARP.  
  
--packet-trace  
Mostra tutti i pacchetti inviati e ricevuti. Se pacchetto S (SYN), SA (SYN ACK), RA (Reset Ack)  
  
-PE -> Nmap automatically ping scan with ICMP Echo Requests  
  
sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace  
  
--top-port=99: top 99 porte

  
-F : Fast scan top 100 porte  
  
-p-: Scan su tutte le porte  
  
--disable-arp-ping Disabilita il ping ARP

  
--max-retries: 1 di default  
  
-sU Esegue una scansione UDP.  
  
-sV Esegue una service scan con in aggiunta informazioni del servizio.

  
Da sudo effettua –sS, da non sudo effettuo –sT

  
xsltproc target.xml -o target.html -> Crea un html visibile

  
--stats-every=5s  
Mostra l'avanzamento della scansione ogni 5 secondi.  
  
-vvv  
 Aumenta la verbosità della scansione, che visualizza informazioni più dettagliate.  
  
-A  
Esegue il rilevamento del servizio, il rilevamento del sistema operativo, il traceroute e utilizza gli script predefiniti per eseguire la scansione del target per cercare eventuali vulnerabilità.  
  
-0  
Rilevamento del sistema operativo ( -O)  
  
-O  
Performs an OS Detection Scan to determine the OS of the target.

  
-A  
Performs OS Detection, Service Detection, and traceroute scans.  
  
-sC  
Perform a Script Scan with scripts that are categorized as "default". NSE

  
--script vuln  
Utilizza tutti gli script correlati dalla categoria specificata.  
  
--max-retries <num>  
Sets the number of retries for scans of specific ports. (default 10)  
  
--stats-every=5s  
Displays scan's status every 5 seconds.  
  
-v/-vv  
Displays verbose output during the scan.  
  
--initial-rtt-timeout 50ms  
Sets the specified time value as initial RTT timeout.  
  
--max-rtt-timeout 100ms  
Sets the specified time value as maximum RTT timeout.  
  
--min-rate 300  
Sets the number of packets that will be sent simultaneously.  
  
-T <0-5> Specifies the specific timing template.

  
--dns-server <ns> DNS resolution is performed by using a specified name server.  
  
-oN tnet.minrate300 Salva i risultati in formati normali, a partire dal nome file specificato.  
  
-T : Thread  
-T 0  -> paranoid  
-T 1 -> sneaky  
-T 2 -> polite  
-T 3 -> normal (default)  
-T 4 -> aggressive

-T 5 -> insane  
  
  
  
nmap –sT –v (verbose) ip 192.168.1.129 : scansione con tutti i dettagli –v  e syn connect –sT

nmap -sP: ping

nmap -sS -v 192.168.7.55 -> Syn Scan

nmap -sT -v 192.168.7.55 -> SYn Connect

nmap -sV versione dei servizi usati per le porte

nmap -sV -iL internal_targets (-p  0-65534 o -p-)

nmap -sL 10.0.0.0/20  
Ti indica gli indirizzi IP della rete e scansiona tutto il CIDR

  
  
Namp Bypass Firewall  
-D RND:5 -> Scansione Decoy Genera cinque indirizzi IP casuali che indicano l'IP di origine da cui proviene la connessione.  
-O Esegue la scansione di rilevamento del sistema operativo.

-S Esegue la scansione della destinazione utilizzando un indirizzo IP di origine diverso.  
-e tun0 Invia tutte le richieste tramite l'interfaccia specificata.  
--source-port 53 -> Esegue le scansioni dalla porta di origine specificata, se è presente una DMZ possiamo provare ad accedere alla rete locale modificando la source port e ip origine per interagire con gli host della rete interna  
  
Se la porta è filtered è possibile che il firewall ci blocchi.  
Se è  presente una DMZ, quindi zona separata tra la rete locale e i server, posso provare ad inserire la –source-port 53 che è la porta DNS, in modo che il firewall bypassi il check pensando la richiesta parta dalla rete locale.  
  
sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace  
sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53  
ncat -nv --source-port 53 10.129.2.28 50000  
  
nmap -n -Pn -iL $1 -p $2 --open  | grep 'scan repo' | cut -f 5 -d ' ' -> Trova partendo da protocollo ($1) e porta ($2) tutti gli host impattati  
  
#!/bin/bash: Informano il sistema che il file contiene una serie di comandi che devono essere passati all'interprete indicato (/bin/bash, /bin/csh o altra shell).  
  
  
nmap -iL nomeFile -sV -Pn -n -oA -oN nmap -oG greppablenmap -oX xml -oA all  
 

  
  
  
 

Scansione TOP:  
sudo nmap 10.129.2.28 -p 139 --packet-trace -n --disable-arp-ping -Pn  
Nmap –sV –Pn –n –oA nmap –oG greppablenmap –oX xml –oA all

Nmap –sS –Pn –v –n –top-ports: TCP Syn Scan + ICMP Echo NOT + porte DNS disable + top 1000 porte

Nmap –sT: Syn Connect

Nmap –sP: Syn Ping

Nmap –sV (syn scan + syn version)

Nmap -sV -iL internal_targets (gli do il file per prendersi gli IP)  
Nmap –sA  è difficile da filtrare per i firewall scansioni, perché arriva un ACK e lo fanno passare  
Nmap –sC syn Script

sudo tcpdump -i eth0 host 192.168.7.36 and 10.129.2.28 : Intercetto i pacchetti dell'interfaccia eth0 su host IP diretti verso x.x.2.28  
  
Scansione TOP 2:  
di solito raccomanderei di fare un syn scan (-sS), -T 4 per la velocita’, -n per evitare operazioni con i dns e —max-retries=1 oppure 2  
a questo punto ti greppi tutte le porte attive e fai una sV (fingerprint del servizio - synVersion).  
  
Su una scansione interna non ha molto senso sulla scansione nmap disattivare il –Pn Echo Request Ping, perché in interno mi aspetto che solo i client possono avere il firewall installato di default.  
Difficilmente un client ha servizi come sqlserver, ssh, rdesktop, rcp, di solito sono proprio solo client e non espongono superficie di attacco.
```