Il Simple Mail Transfer Protocol (SMTP) è un protocollo per l'invio di e-mail in una rete IP. Può essere utilizzato tra un client di posta elettronica e un server di posta in uscita o tra due server SMTP. SMTP è spesso combinato con i protocolli IMAP o POP3, che possono recuperare e inviare e-mail. In linea di principio si tratta di un protocollo basato su client-server, sebbene SMTP possa essere utilizzato tra un client e un server e tra due server SMTP. In questo caso, un server funge effettivamente da client.  SMTP funziona in modo non crittografato senza ulteriori misure e trasmette tutti i comandi, i dati e le informazioni di autenticazione in testo semplice. Per impedire la lettura non autorizzata dei dati, l'SMTP viene utilizzato insieme alla crittografia SSL/TLS. In determinate circostanze, un server utilizza una porta diversa dalla porta TCP standard 25per la connessione crittografata, ad esempio TCP port 465.  A questo scopo è stata sviluppata un'estensione per SMTP denominata Extended SMTP( ESMTP). Quando si parla di SMTP in generale, di solito si intende ESMTP. ESMTP utilizza TLS, che viene eseguito dopo il EHLO comando inviando STARTTLS. Questo inizializza la connessione SMTP protetta tramite SSL e da questo momento in poi l'intera connessione è crittografata e quindi più o meno sicura. Ora anche l'estensione AUTH PLAIN per l'autenticazione può essere utilizzata in sicurezza.



SMTP - Command:
```
Enumerare gli utenti:
> nmap -sV 192.63.243.3
> nmap -sV -A -T4 -p25,587 --script smtp-enum-users.nse 10.129.17.225
> use auxiliary/scanner/smtp/smtp_enum

Banner Grabbing:
> nc 192.63.243.3 25
> telnet 192.63.243.3 25

# SMTP-User-Enum - Enumeration:
> smtp-user-enum -U /usr/share/commix/src/txt/usernames.txt -t 192.63.243.3
> smtp-user-enum -M VRFY -U footprinting-wordlist.txt -t 10.129.209.62
> use auxiliary/scanner/smtp/smtp_enum

SMTP - Telnet connection + Send fake mail:
> telnet 192.26.29.3 25 
> HELO attacker.xyz 
> mail from: admin@attacker.xyz
> rcpt to:root@openmailbox.xyz 
> data 
> Subject: Hi Root Hello, This is a fake mail sent using telnet command. From, Admin
> .
Note: There is a dot(.) in the last line which indicates the termination of data.



SMTP - Send fake mail:
sendemail -f admin@attacker.xyz -t root@openmailbox.xyz -s 192.63.243.3 -u Fakemail -m "Hi root, a fake mail from admin" -o tls=no


SMTP - Verify Existing Users:
> nc 192.168.0.10 25
> VRFY admin@openmailbox.xyz


AUTH è un'estensione del servizio utilizzata per autenticare il client.:
> AUTH PLAIN

Il client effettua il login con il nome del suo computer e avvia così la sessione:
> HELO 

Il client nomina il mittente dell'e-mail:
> MAIL FROM 

Il client nomina il destinatario dell'e-mail:
> RCPT TO 

Il client avvia la trasmissione dell'e-mail:
> DATA

Il client interrompe la trasmissione avviata ma mantiene la connessione tra client e server:
> RSET 

Il client controlla se è disponibile una casella di posta per il trasferimento dei messaggi:
> VRFY 

Il client controlla anche se una casella di posta è disponibile per la messaggistica con questo comando:
> EXPN 

Il client richiede una risposta dal server per impedire la disconnessione dovuta al timeout:
> NOOP 

Il client termina la sessione:
> QUIT 

Indica i comandi utilizzabili sul server:
> EHLO 

 ```

