
```
### Authentication Vulnerabilities

- Qualcosa che conosci
- Qualcosa che hai
- Qualcosa che sei o fai


Authentication:
- Verifica che un utente sia chi dichiara di essere


Authorization:
- Verifica se a un utente è consentito fare qualcosa

```




```
## Authentication - LAB Apprentice



#1. Bruteforce login with credentials:
Attention to different response code/length/time



#2. 2FA bypass:
When prompted for the verification code, manually change the URL to navigate to /my-account bypassing the 2FA, accendendo all'url al quale si dovrebbe accedere normalmente post verifica del 2FA.



#3. Password reimpostata leak policy:
E' possibile utilizzare il token di un utenza valida, e modificare l'username durante la POST per reset password

```

```
## Authentication - LAB Practitioner



#4. Enumeration username:
Sfrutto user enumeration per fare bruteforce dell'username e password.



#5. User Time Based Enumeration:
Add "X-Forwarded-For" header to bypassing whitelisting IP.
User Enumeration with Time Based



#6. Blocco IP ogni tot errori di login:
Uso un Resource Pool con thread bassi, e creo un bruteforce attack alternando username e password corretti al bruteforcing.



#7. User Enumeration Error Based:
Utilizzo il fatto che utilizzando utenze valide e con tanti tentativi ricevo un errore che mi fa intuire che l'utenza esiste "You have made too many incorrect login attempts". 
Su utenze non esistenti non si viene bloccati per troppi tentativi



#8. 2FA Weak Business Logic:
Modifico la Business Logic del 2FA per trovare vulnerabilità.
Es. Faccio l'accesso con una utenza, quando viene richiamata la POST per inviare il 2FA, inserisco l'username di un'altra utenza



#9. Bruteforce Cookie Weak Policy:
Cookie utilizza base64(username + MD5(password))
Utilizzo bruteforcing sull'intruder con le regole per il settings del Payload.



#10. Cracking Password:
Cookie is <username+':'+md5HashOfPassword>



#11. Avvelenamento da reimpostazione password tramite middleware:
E' supportata ed è possibile utilizzarla per indirizzare il collegamento di ripristino generato dinamicamente a un dominio arbitrario. 

X-Forwarded-Host: YOUR-EXPLOIT-SERVER-ID.exploit-server.net

X-Forwarded-Host è un metodo comune usato per identificare l'host originale richiesto dal client nell'intestazione della richiesta HTTP host. Ciò è dovuto al fatto che il nome host di Frontdoor può differire per il server back-end che gestisce la richiesta. Qualsiasi valore precedente verrà sostituito da Frontdoor. Se ho ad es. un LoadBalancer, la mia richiesta verrà indirizzata verso il mio Forwarded-Host indicato.  



#12. BruteForce tramite modifica della password:
Bruteforcing Passowrd, utilizzando il reimpostazione nuova password di un account, sbaglio appositamente le due nuove password per non farle combaciare, e vado a cambiare l'username in modo da poter enumerare la vecchia password.
Quando ho "New passwords do not match" probabilmente la "current-password" era quella reale.
```


```
## Authentication - LAB Expert


```


