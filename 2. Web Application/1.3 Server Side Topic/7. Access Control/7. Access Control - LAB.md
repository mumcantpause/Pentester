

```
#General
> ?admin=true
> ?role=1

> "X-Original-URL" o "X-Rewrite-URL" 

> Se il controllo è client-side modifica parametri di response che vengono memorizzati in sessione (es. "admin=true")

> URL case sensitive: /ADMIN/DELETEUSER

> Provare a modificare GET che effettuano accesso al profilo, aggiungendo/modificando l'id:
/myaccount?id=123.


```

```
#1. Funzionalità amministrative non protette

 > "file" /robots.txt 
 Include admin panel information
 > go to "file" /administrator-panel 
```

```
#2. Funzionalità amministrative 

JavaScript that discloses the URL of the admin panel
```

```
#3. Ruolo utente controllato da request param

Browse to /admin and observe that you can't access the admin panel.
Observe that the response sets the cookie Admin=false. Change it to Admin=true

```


```
#4. Ruolo utente non modificabile nel profilo utente

> roleId: 2=admin - roleId: 1=normal user
> Add "roleid":2 into the JSON in the request body, and resend it. 
> Browse to /admin and delete carlos. 

```


```
#5. ID utente controllato dal parametro di richiesta

> URL contains your username in the "id" parameter. 
> Change the "id" parameter to carlos. 
> Retrieve and submit the API key for carlos.
```


```
#6. ID utente controllato dal parametro di richiesta, con ID utente imprevedibili 

> Trova un post sul blog di carlos.
> Clicca su carlose osserva che l'URL contiene il suo ID utente. Prendere nota di questo ID.
> Accedi utilizzando le credenziali fornite e accedi alla pagina del tuo account.
> Modificare il parametro "id" con l'ID utente salvato. 

```

```
#7. ID utente controllato dal parametro di richiesta con perdita di dati nel reindirizzamento

> Cambia il parametro "id" in carlos.
>  Osserva che sebbene la risposta ora ti reindirizzi alla home page, ha un corpo contenente la chiave API appartenente a carlos. 
```

```
#8. ID utente controllato dal parametro di richiesta con divulgazione della password.

> Effettua il login utilizzando le credenziali fornite e accedi alla pagina dell'account utente.
> Cambia il parametro "id" nell'URL in administrator.
> Visualizza la risposta in Burp e osserva che contiene la password dell'amministratore.

```

```
#9. IDOR

> URL e osservare che le trascrizioni sono file di testo a cui è assegnato un nome file contenente un numero incrementale
> Cambia il nome del file che è incrementale 1.txt

```

```
#10. Access Control Bypassing - Headers

> GET /
> X-Original-URL: /admin
> x-Rewrite-URL: /admin

> GET /?username=carlos
> X-Original-URL: /admin/delete
> X-Original-URL: /admin/delete
```

```
#11. Access Control Bypassing - HTTP Method

> Change HTTP Method from POST to GET to obtain new privileges

```

```
#12. Multi-step process with no acces control on one step

> Copia il cookie di sessione dell'utente non amministratore nella richiesta del ripetitore esistente, modifica il nome utente con il tuo e riproducilo. 

```

```
#13. Access Control Bypassing - Referer Header

> /admin-roles?username=carlos&action=upgrade 
Observe that the request is treated as unauthorized due to the absent Referer header

> Modify "Referer Header": in admin header

```


