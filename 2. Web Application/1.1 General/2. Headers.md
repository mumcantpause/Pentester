
```

## X-Forwarded-For: 
X-Forwarded-For metodo per identificare l'indirizzo IP di origine di un client che si connette ad un indirizzo IP, modificandolo alcune volte è possibile evitare venga bloccato un IP (permette di fare spoofing), inserisco una password lunga e valuto il tempo impiegato sulle request con username valido.  



## X-Forwarded-Host:
Il campo intestazione HTTP X-Forwarded-Host è un metodo comune usato per identificare l'host originale richiesto dal client nell'intestazione della richiesta HTTP host. Ciò è dovuto al fatto che il nome host di Frontdoor può differire per il server back-end che gestisce la richiesta. Qualsiasi valore precedente verrà sostituito da Frontdoor. Se ho ad es. un LoadBalancer, la mia richiesta verrà indirizzata verso il mio Forwarded-Host indicato.  



## X-Original-URL - X-Rewrite-URL: 
Se un sito Web utilizza rigorosi controlli front-end per limitare l'accesso in base all'URL, ma l'applicazione consente di sovrascrivere l'URL tramite un'intestazione di richiesta, potrebbe essere possibile ignorare i controlli di accesso  

Non permessa: 
GET /admin/delete?username=carlos HTTP/2  

Permessa: 
GET /?username=carlos HTTP/2  
X-Original-URL: /admin/delete  



## Referer:
Header che fa riferimento alla pagina da cui è stata avviata la richiesta. Alcuni siti usano dei check sull' Header Referer (es. si aspettano che siano ./admin), per concedere il controllo della risorsa. 
E' possibile iniettare del codice malevolo sul Referer, in quanto solitamente è un campo gestito lato Server che effettua delle logiche.  



## Content-Type:
Intestazione della risposta può fornire indizi sul tipo di file che il server pensa di aver servito. Se questa intestazione non è stata impostata in modo esplicito dal codice dell'applicazione, normalmente contiene il risultato della mappatura dell'estensione del file/tipo MIME. Es. Se ho un file php e valorizzo content-type: image/jpeg il server se non effettua ulteriori check lo considera un file .jpeg, se invece non viene valorizzato il content type, il server verifica l'estensione del file e ne estrapola il mime type e stabilisce se è un mime accettabile  



## Content-Disposition:
Fornisce alcune informazioni di base sul campo di input a cui si riferisce (es. form-data; name="description").



## HttpOnlyFlag: 
Nascondono i propri cookie da JavaScript utilizzando il HttpOnlyflag.  



## Secure – Anti-Cookies:
Inviano cookie solo se la connessione è sicura https (e non http).  



## SameSite - Anti-Cookies: 
SameSite: Invia Cookie solo se sullo stesso sito, sito esterno, nessuno (Strict, Lact HttpOnly: Nascondo il Cookie da Javascript Secure: Nascondo Cookie su connessioni HTTP  setcookie("sessionid", "QmFieWxvbiA1", ['httponly' => true, 'secure' => true, 'samesite'=>'Strict']);   
SameSite è un meccanismo di sicurezza del browser che determina quando i cookie di un sito Web vengono inclusi nelle richieste provenienti da altri siti Web. Poiché le richieste di eseguire azioni sensibili in genere richiedono un cookie di sessione autenticato, le restrizioni SameSite appropriate possono impedire a un utente malintenzionato di attivare queste azioni tra i siti. Dal 2021, Chrome applica Laxle restrizioni SameSite per impostazione predefinita. Poiché questo è lo standard proposto, ci aspettiamo che altri browser importanti adottino questo comportamento in futuro. Strict: Invia cookie solo dalla stessa origine Lax: Solo da stessa origine, ma anche se all'interno dell'origine vado su un external site None: Invio sempre il cookies.  



## CSRF Token - Token anti-CSRF:
Un token CSRF è un valore univoco, segreto e imprevedibile generato dall'applicazione lato server e condiviso con il client. Quando si tenta di eseguire un'azione riservata, come l'invio di un modulo, il client deve includere nella richiesta il token CSRF corretto. Ciò rende molto difficile per un utente malintenzionato costruire una richiesta valida per conto della vittima.  



## CORS:
Specifica che permette l'accesso controllato al ad un dominio da un origine differente. Solitamente viene richiesta per le richieste non GET una preflight, ossia una chiamata dell'API in OPTIONS prima di effettuare la chiamata reale. In response dell'OPTIONS vengono settati nell'header i valori che identificano il perimetro di accesso della richiesta.  Access-LP n-Allow-Origin: * Access-Control-Allow-Credentials: true  



## Same Origin Policy (SOP):
E' un meccanismo del browser che verifica se il mittente di origine è lo stesso del browser a cui si vuole accedere. Effettua dei check ustilizzando lo schema mittente/destinatario (http -> http), dominio (normal-website.com/ -> normal-website.com) port number (80 -> 80). Questo meccanismo viene esteso ed arricchito dalla politica CORS.    



## Content-Security-Policy (CSP):
E' un meccanismo del browser che mira a mitigare l'impatto del cross-site scripting e di alcune altre vulnerabilità. Se un'applicazione che utilizza CSP contiene un comportamento simile a XSS, il CSP potrebbe ostacolare o impedire lo sfruttamento della vulnerabilità. Spesso, il CSP può essere aggirato per consentire lo sfruttamento della vulnerabilità sottostante. Funziona limitando le risorse (come script e immagini) che una pagina può caricare e limitando se una pagina può essere incorniciata da altre pagine.  Content-Security-Policy: La seguente direttiva consentirà solo agli script di essere caricati dalla stessa origine della pagina stessa: Content-Security-Policy: policy, dove policy è una stringa di direttive di policy separate da punti e virgola. Content-Security-Policy: script-src 'self', frame-ancestors 'self'; img-src Content-Security-Policy: frame-ancestors normal-website.com;  



## script-src 'self' - Content-Security-Policy (CSP):
La seguente direttiva consentirà solo agli script di essere caricati da un dominio specifico: script-src https://scripts.normal-website.com Il browser Chrome ha deciso di affrontare gli attacchi di markup penzolanti impedendo a tag come imgla definizione di URL contenenti caratteri non elaborati come parentesi angolari e newline. Ciò impedirà gli attacchi poiché i dati che altrimenti verrebbero acquisiti conterranno generalmente quei caratteri non elaborati, quindi l'attacco viene bloccato. Potresti incontrare un sito Web che riflette l'input nella politica effettiva, molto probabilmente in una report-uridirettiva. Chrome ha recentemente introdotto la script-src-elemdirettiva, che consente di controllare scriptgli elementi, ma non gli eventi. Fondamentalmente, questa nuova direttiva consente di sovrascrivere le direttive esistentiscript-src.   



## Frame-ancestors - Content-Security-Policy (CSP):
La seguente direttiva consentirà solo alla pagina di essere incorniciata da altre pagine dalla stessa origine: frame-ancestors 'self' La seguente direttiva impedirà del tutto il framing: frame-ancestors 'none'.  



## X-Frame-Options - Content-Security-Policy (CSP):
(legacy of frame-ancestors) X – Frame-Options è la versione legacy del frame-ancestors implementato con il CSP. L'intestazione della risposta HTTP X-Frame-Options può essere utilizzata per indicare se a un browser deve essere consentito o meno di eseguire il rendering di una pagina in un <frame> , <iframe> , <embed> o <object> . I siti possono utilizzarlo per evitare attacchi di clickjacking, assicurandosi che il loro contenuto non sia incorporato in altri siti.  X-Frame-Options è stato originariamente introdotto come intestazione di risposta non ufficiale in Internet Explorer 8 ed è stato rapidamente adottato in altri browser. L'intestazione fornisce al proprietario del sito Web il controllo sull'uso di iframe o oggetti in modo che l'inclusione di una pagina Web all'interno di un frame possa essere vietata con la denydirettiva:  X-Frame-Options: deny In alternativa, il framing può essere limitato alla stessa origine del sito Web utilizzando la sameorigindirettiva.  X-Frame-Options: sameorigin o a un sito Web denominato utilizzando la allow-fromdirettiva: X-Frame-Options: allow-from [https://normal-website.com](https://normal-website.com/)  



## img-src 'self' - Content-Security-Policy (CSP):
Permette l'esecuzione del tag solo dalla stessa origine  



## X-Content-Type-Options 
L'intestazione HTTP della risposta X-Content-Type-Options è un indicatore utilizzato dal server per indicare che il browser non deve utilizzare il tipi MIME partendo dall'estensione del file, ma si deve fidare del Content-Type. L'intestazione consente di evitare lo sniffing del tipo MIME dicendo che i tipi MIME sono deliberatamente configurati. Se ho quindi un file .php che sono riuscito a caricare bypassando il check sul Content-Type inserendolo come text/plain, quando lo vado a richiedere al server mi darà nuovamente il .php che però io gestirò come testo e non verrà eseguito lo script.



## Cache Control: Private:
Tell Server to no Caching Public: Indica che la risposta può essere cachata no-cache: Istruisce il client a rivalidare la risposta con il server prima di utilizzare la versione cachata no-store: Not store any version of the response. Max-age: Maximum amount time that response can be cached by the client



```