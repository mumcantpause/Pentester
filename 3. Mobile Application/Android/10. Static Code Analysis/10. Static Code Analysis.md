
```

10.1 Static Code Analysis 
10.2 SQL Injection 
10.3 Path/Directory Traversal 
10.4 Vulnerable Activities 
10.5 Vulnerable Receivers 
10.6 Vulnerable Services 
10.7 Shared Preferences 
10.8 Local Databases 
10.9 Tools 

 

 

 

10.1 Static Code Analysis: 
- Analyze AndroidManifest.xml, con focus su Intents and Extras che vengono accettati come input dall'app 
- Analyze AndroidManifest.xml, con focus sul comportamento delle WebViews, file storage, e le componenti esposte all'attacco. 
 
 

10.2 SQL Injection: 
strings classes.dex | grep "content://" -> Utile per estrarre dal file classes, stringhe stampabili dal binario .dex e greppare cercando il comando di content 
 

 

10.3 Path/Directory Traversal: 
content://com.adobe.reader.fileprovider/../../../file_to_read 
 
10.4 Vulnerable Activities 
Activities priva di android:permision e exported=true, rende possibile richiamare un intent per spawnare l'activity 

 (es. con Objection) 

 

 

10.5 Vulnerable Receivers 
L'obiettivo è quello di ricevere dati. Anche qui come per le activities è necessario impostare i flag per gestire correttamente i permessi. 
 
 
10.6 Vulnerable Services: 
Idem, se non vengono gestiti i permessi e exported=true può essere richiamato dall'esterno causando danni 
 
10.7 Shared Preferences: 
Cartella all'interno dell'internal storage in cui spesso si salvano dati utili all'app. 
Usando adb è possibile visualizzare il contenuto 
data/data/com.esempio/shared_prefs 
 
10.8 Databases: 
Database locali utilizzando sqlite3 
data/data/com.esempio/databases/Email.db 
 

10.9 Tools 
Drozer from MWR, permette di enumerare la superficie di attacco, interagire con le componenti dell'app, etc 
 
 
 
 
QARK Tools: 
Parse Java Code 

 

 

 

SAST - Static Application Security Testing: 
Utilizza Semgrep rule, per coprire tutte le regole della mobile testing guide.  
Copre praticamente quasi il 70% dei test sul totale delle mobile table testing guide. 
Utilizza Semgrep, ossia un SAST tools, analizza ogni file e lo isola, ti permette di definire dei pattern per poter analizzare i file. 
I pattern ci sono sia per la parte Xml che per la parte Java 
Il codice non viene mai uploadato ma l'analisi viene effettuata localmente. 
Alternative Semgrep, SonarQube, Snyk, CodeQL, CheckMarx. 
 
Pinning certificato 
https://antreem.com/it/blog/certificate-pinning-aumentare-il-livello-di-sicurezza-delle-connessioni 
Una volta stabilita l'associazione tra host e certificato, la relazione tra i due viene formalizzata, fissando il certificato a quell'host. Una connessione sicura con un client o una chiamata API viene approvata solo nei casi in cui il certificato offerto esiste all'interno di quel set di certificati aggiunti. 
 
jadx -d target_src <nome>.apk 
semgrep -c ./rules ./target_src 

 
 
 
Qark: 
 

 

 

 

```