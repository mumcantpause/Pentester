

```
###. Drozer - Install

Available only with python 2.7

#. Setting Specific Version of Python:
> sudo update-alternatives --config python
[update-alternatives: error: no alternatives for python3]

You need to update your update-alternatives , then you will be able to set your default python version.

> sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.4 1
> sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2

Then run :

> sudo update-alternatives --config python
Or 
> sudo update-alternatives  --set python /usr/bin/python3.6




wget https://github.com/FSecureLABS/drozer/releases/download/2.4.4/drozer-2.4.4-py2-none-any.whl
apt-get --assume-yes install python-pip
pip2 install wheel
pip2 install pyyaml
pip2 install pyhamcrest (if error: pip install --upgrade setuptools)
pip2 install protobuf 
pip2 install pyopenssl 
pip2 install twisted
pip2 install service_identity
pip2 install drozer-2.4.4-py2-none-any.whl


Download APK Drozer and install in emulator/devices:

> adb install drozero.apk
> adb forward tcp:31415 tcp:31415

Connect:
> drozer console connect




```

```
###. Drozer


# List Packages:
dz> run app.package.list -f app.package
[com.app.package]

# Basic Information of the package:
dz> run app.package.info -a com.app.package


# Attack Surface of the package:
dz> run app.package.attacksurface com.app.package
[ Attack Surface:
 3 activities exported
 0 broadcast receivers exported
 2 content providers exported
 2 services exported
 is debuggable ]

Activity? Maybe u can start an activity and bypass authorization
Content Providers? Maybe u can access private data or exploit some vulnerabilities
Service?
Is Debuggable?



#. Drozer - Activity
<activity android:name="com.my.app.Initial" android:exported="true">
</activity>

dz> run app.activity.info -a com.mwr.example.sieve
[ Package: com.mwr.example.sieve
 com.mwr.example.sieve.FileSelectActivity
 com.mwr.example.sieve.MainLoginActivity
 com.mwr.example.sieve.PWList ]

#Start Activity
dz> run app.activity.start --component com.mwr.example.sieve com.mwr.example.sieve.PWList
#or from ADB:
adb shell am start -n com.example.demo/com.example.test.MainActivity
adb am start -n #app package/component
-a android.intent.action.MAIN #Action details
-c android.intent.category.LAUNCHER #Category





#. Drozer - Service:
<service android:name=".AuthService" android:exported="true" android:process=":remote"/>
Inside the code check for the **handleMessage**function which will receive the message:

app.service.info            Info Service
app.service.send            Send a Message to a service, and display the reply  
app.service.start           Start Service                                       
app.service.stop            Stop Service


Drozer - List Service Info:
dz> run app.service.info -a com.mwr.example.sieve 
Package: com.mwr.example.sieve
  com.mwr.example.sieve.AuthService
    Permission: null
  com.mwr.example.sieve.CryptoService
    Permission: null




Drozer - Send Message to Service:
Nota che invierai prima i dati all'interno di " msg.what ", poi " msg.arg1 " e " msg.arg2 ", dovresti controllare all'interno del codice quali informazioni vengono utilizzate e dove. Usando l' --extraopzione puoi inviare qualcosa interpretato da " msg.replyTo" e usando --bundle-as-objpuoi creare e obiettare con i dettagli forniti.

Nell'esempio seguente:
what == 2354
arg1 == 9234
arg2 == 1
replyTo == object(string com.mwr.example.sieve.PIN 1337)


run app.service.send com.mwr.example.sieve com.mwr.example.sieve.AuthService --msg 2354 9234 1 --extra string com.mwr.example.sieve.PIN 1337 --bundle-as-obj





###. Drozer - Broadcast Receiver:
Dopo aver scoperto questi ricevitori di trasmissione dovresti controllarne il codice . Presta particolare attenzione alla onReceive funzione poiché gestirà i messaggi ricevuti.


#. Drozer - List Broadcast Receiver:
app.broadcast.info          Get information about broadcast receivers           
app.broadcast.send          Send broadcast using an intent                      
app.broadcast.sniff         Register a broadcast receiver that can sniff particular intents

Es. 
dz> run app.broadcast.info -a my.app.package


Es. Utilizzo un BroadcastReceivers per inviare un SMS a qualsiasi destinazione senza chiedere il permesso all'utente.
https://github.com/linkedin/qark/blob/master/tests/goatdroid.apk

Ho il mio Receivers Send SMS Now Receiver, che è in ascolto da azioni provenienti da "SOCIAL_SMS", leggo il codice del Receiver ed il metodo onReceive ed invio l'action.

<receiver android:label"Send SMS" android:name=".broadcastreceivers.SendSMSNowReceiver">
<intent-filter>
<action android:name= org.owasp.goatdroid.fourgats.SOCIAL_SMS" />
</intent-filter>
</receiver>

run app.broadcast.send --action org.owasp.goatdroid.fourgoats.SOCIAL_SMS --component org.owasp.goatdroid.fourgoats.broadcastreceivers SendSMSNowReceiver --extra string phoneNumber 123456789 --extra string message "Hello mate!"

ADB Manual - Broadcast Receivers - 
adb shell am start -a android.intent.action.VIEW -d "scheme://hostname/path?param=value" [your.package.name]


###. Drozer Content-Providers:





##. Drozer - Debugging:
run app.package.debuggable   # Check App Debuggable


```

